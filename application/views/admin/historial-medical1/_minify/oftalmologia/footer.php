<?php foreach($show_oft as $img) ?>

<script>
let pointSize2=3;var points2=[],timeout2=300,clicks2=0;const canvas2=document.getElementById("canvas3"),ctx2=canvas2.getContext("2d");let cw2=canvas2.width=400,ch2=canvas2.height=200;function getPosition2(e){var o=canvas2.getBoundingClientRect();return{x:e.clientX-o.left,y:e.clientY-o.top}}function drawCoordinates2(e,o){ctx2.fillStyle="#ff2626",ctx2.beginPath(),ctx2.arc(e.x,e.y,o,0,2*Math.PI,!0),ctx2.fill()}function oyo(){base_image_oj=new Image,base_image_oj.src="<?= base_url();?>assets/img/oftal/<?php echo $img->ojo; ?>",base_image_oj.onload=function(){ctx2.drawImage(base_image_oj,0,0)}}canvas2.addEventListener("click",function(e){clicks2++;var o=getPosition2(e);drawCoordinates2(o,pointSize2),1==clicks2&&setTimeout(function(){if(1==clicks2)points2.push(o);else{for(let e=0;e<points2.length;e++)if(ctx2.beginPath(),ctx2.arc(points2[e].x,points2[e].y,pointSize2,0,2*Math.PI,!0),ctx2.isPointInPath(o.x,o.y)){points2.splice(e,1);break}ctx2.clearRect(0,0,cw2,ch2)}ctx2.drawImage(base_image_oj,0,0),points2.map(e=>{drawCoordinates2(e,pointSize2)}),clicks2=0},timeout2)}),oyo();let pointSize22=3;var points22=[],timeout22=300,clicks22=0;const canvas22=document.getElementById("canvas4"),ctx22=canvas22.getContext("2d");let cw22=canvas22.width=400,ch22=canvas22.height=200;function getPosition22(e){var o=canvas22.getBoundingClientRect();return{x:e.clientX-o.left,y:e.clientY-o.top}}function drawCoordinates22(e,o){ctx22.fillStyle="#ff2626",ctx22.beginPath(),ctx22.arc(e.x,e.y,o,0,2*Math.PI,!0),ctx22.fill()}function fondo2(){base_image_fondo2=new Image,base_image_fondo2.src="<?= base_url();?>assets/img/oftal/<?php echo $img->fondo; ?>",base_image_fondo2.onload=function(){ctx22.drawImage(base_image_fondo2,0,0)}}canvas22.addEventListener("click",function(e){clicks22++;var o=getPosition22(e);drawCoordinates22(o,pointSize22),1==clicks22&&setTimeout(function(){if(1==clicks22)points22.push(o);else{for(let e=0;e<points22.length;e++)if(ctx22.beginPath(),ctx22.arc(points22[e].x,points22[e].y,pointSize22,0,2*Math.PI,!0),ctx22.isPointInPath(o.x,o.y)){points22.splice(e,1);break}ctx22.clearRect(0,0,cw22,ch22)}ctx22.drawImage(base_image_fondo2,0,0),points22.map(e=>{drawCoordinates22(e,pointSize22)}),clicks22=0},timeout22)}),fondo2(),$(".disable-all :input").prop("disabled",!0),$(".show_modif_enf_act").on("click",function(e){$(".show_modif_enf_act").hide(),$(".save_enf_act_hide").slideDown(),$(".disable-all :input").prop("disabled",!1)}),$("#save_of_hide").on("click",function(e){e.preventDefault();var o=$("#id_oftal").val(),a=$("#od_con_core").val(),n=$("#od_sin_cone").val(),t=$("input[name='od_mas_o_menoe']:checked").val(),i=$("#od_cor_acte").val(),s=$("#os_sin_cone").val(),c=$("#os_con_core").val(),l=$("input[name='os_mas_o_menoe']:checked").val(),r=$("#os_cor_acte").val(),d=$("#updated_by").val(),_=$("#not-oftmed").val(),v=$("#retine1e").val(),m=$("#retine2e").val(),p=$("#retine3e").val(),f=$("#retine4e").val(),u=$("#retine5e").val(),h=$("#retine6e").val(),g=$("#retine7e").val(),x=$("#retine8e").val(),b=$("input[name='masomenos1e']:checked").val(),k=$("input[name='masomenos2e']:checked").val(),w=$("input[name='masomenos3e']:checked").val(),j=$("input[name='masomenos4e']:checked").val(),y=$("input[name='masomenos5e']:checked").val(),P=$("input[name='masomenos6e']:checked").val(),I=$("input[name='masomenos7e']:checked").val(),S=$("input[name='masomenos8e']:checked").val(),C=$("#ppme").val(),z=$("#converge").val(),R=$("#ducverse").val(),D=$("#converteste").val(),T=$("input[name='od_espera_re']:checked").val(),L=$("#od_esperae").val(),B=$("#od_cilindroe").val(),E=$("input[name='od_cilindro_re']:checked").val(),M=$("#eje_ode").val(),X=$("#add_ode").val(),U=$("#vision_ode").val(),q=$("#os_esperae").val(),H=$("input[name='os_espera_re']:checked").val(),O=$("#os_cilindroe").val(),Y=$("input[name='os_cilindro_re']:checked").val(),A=$("#eje_ose").val(),F=$("#add_ose").val(),G=$("#vision_ose").val(),J=$("#conj1e").val(),K=$("#conj2e").val(),N=$("#cornea1e").val(),Q=$("#cornea2e").val(),V=$("#pup1e").val(),W=$("#pup2e").val(),Z=$("#crist1e").val(),ee=$("#crist2e").val(),oe=$("#vitreo1e").val(),ae=$("#vitreo2e").val(),ne=$("#fondos1e").val(),te=$("#fondos2e").val(),ie=canvas3.toDataURL("image/png"),se=canvas4.toDataURL("image/png");return $("#save_of_hide").prop("disabled",!0),$.ajax({type:"POST",url:"<?=base_url('admin_medico/SaveUpOftala')?>",data:{od_sin_con:n,od_con_cor:a,od_mas_o_meno:t,od_cor_act:i,os_sin_con:s,os_con_cor:c,os_mas_o_meno:l,os_cor_act:r,retine1:v,retine2:m,retine3:p,retine4:f,retine5:u,retine6:h,retine7:g,retine8:x,canvasData1:ie,canvasData2:se,ppm:C,converg:z,ducvers:R,convertest:D,notaof:_,masomenos1:b,masomenos2:k,masomenos3:w,masomenos4:j,masomenos5:y,masomenos6:P,masomenos7:I,masomenos8:S,od_espera_r:T,od_espera:L,od_cilindro:B,od_cilindro_r:E,eje_od:M,add_od:X,vision_od:U,os_espera:q,os_espera_r:H,os_cilindro:O,os_cilindro_r:Y,eje_os:A,add_os:F,vision_os:G,conj1:J,conj2:K,cornea1:N,cornea2:Q,pup1:V,pup2:W,crist1:Z,crist2:ee,vitreo1:oe,vitreo2:ae,fondos1:ne,fondos2:te,id_oftal:o,updated_by:d},cache:!0,error:function(e,o,a){alert("An erroroccurred... Look at the console (F12 or Ctrl+Shift+I, Console tab) for more information!"),$("#erorof").html("<p>statuscode: "+e.status+"</p><p>errorThrown: "+a+"</p><p>jqXHR.responseText:</p><div>"+e.responseText+"</div>"),console.log("jqXHR:"),console.log(e),console.log("textStatus:"),console.log(o),console.log("errorThrown:"),console.log(a)},success:function(e){alert("Cambiado ha sido hecho !"),$(".show_modif_enf_act").slideDown(),$(".save_enf_act_hide").hide(),$("#erorof").html(e),$(".disable-all :input").prop("disabled",!0),$("#save_of_hide").prop("disabled",!1)}}),!1});
</script>