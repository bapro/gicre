<br><style>.box-tooltip2{color:#000;background:#fff;border-radius:20px;padding:6px;border:1px solid red;z-index:100000}.pagination2{display:inline-block}.btn-select-file{border-radius:20px}.thumb{margin:24px 5px 20px 0;width:150px;float:left}#blah{border:2px solid;display:block;background-color:#fff;border-radius:5px}</style><h4 class="h4 his_med_title">Historia de la enfermedad actual (<b><?=$count_enf?>regitros (s)</b>)</h4><br><?php if($count_enf>0){$i=1;foreach($enfermedad as $row){if($row->laboratorios==""){$lab="";}else{$lab="<li><strong>Laboratorios (Resultados relevantes)</strong> : $row->laboratorios</li>";}if($row->estudios==""){$est="";}else{$est="<li><strong>Estudios (Resultados relevantes)</strong> : $row->estudios</li>";}$img=$this->db->select('image')->where('id_enfermedad',$row->id_enf)->get('saveEnfImage')->row('image');if($img==""){$enimg="";}else{$enimg='<li style="color:red">Hay imagen</li>';}$user_c14=$this->db->select('name')->where('id_user',$row->inserted_by)->get('users')->row('name');$user_c15=$this->db->select('name')->where('id_user',$row->updated_by)->get('users')->row('name');$inserted_time=date("d-m-Y H:i:s",strtotime($row->inserted_time));$updated_time=date("d-m-Y H:i:s",strtotime($row->updated_time));$centro=$this->db->select('name')->where('id_m_c',$row->centro_medico)->get('medical_centers')->row('name'); ?><div class="pagination"><a href="<?php echo base_url("admin_medico/show_enfermedad/$row->id_enf/$user_id/$row->centro_medico") ?>"data-target="#ver_enf_act"data-toggle="modal"><?php echo $i;$i++; ?></a><br><br><div class="box-tooltip"style="display:none;position:absolute"><h4 style="color:green"><?=$centro?></h4><ul style="list-style:none"><li>Creado por<?=$user_c14?>,<?=$inserted_time?></li><li>Cambiado por<?=$user_c15?>,<?=$updated_time?></li><hr><li><strong>Motivo de consulta</strong> :<?=$row->enf_motivo?></li><li><strong>Sinopsis</strong> :<?=$row->signopsis?></li><?=$lab?><?=$est?><?=$enimg?></ul></div></div><?php }$sql1="SELECT  historial_id FROM  h_c_enfermedad WHERE historial_id=$id_historial AND id_triaje !=0 GROUP BY historial_id";$triaje_sig1=$this->db->query($sql1);foreach($triaje_sig1->result()as $rowTriage1){ ?><div class="pagination2"><i class="fa fa-asterisk"style="color:red">Emergencia</i><div class="box-tooltip2"style="display:none;position:absolute"><h4 style="color:red">EMERGENCIA</h4><?php $sql="SELECT signopsis, inserted_by, inserted_time, id_triaje FROM  h_c_enfermedad WHERE id_triaje !=0";$triaje_sig=$this->db->query($sql); ?><span><strong>Sinopsis</strong></span><ul><?php foreach($triaje_sig->result()as $rowTriage){$user_triaje=$this->db->select('name')->where('id_user',$rowTriage->inserted_by)->get('users')->row('name');$perf=$this->db->select('perfil')->where('id_user',$user_id)->get('users')->row('perfil');if($perf=="Admin"){$contlr="admin";}else{$contlr="medico";}$time_triaje=date("d-m-Y H:i:s",strtotime($rowTriage->inserted_time)); ?><li><a href="<?php echo base_url("$contlr/emergency_triaje/$id_historial/$rowTriage->id_triaje#enf") ?>"class="not-triaje"style="font-size:15px"title="Ir a la emergencia para ver mas"><?=$rowTriage->signopsis?>-> Creado por<?=$user_triaje?>,<?=$time_triaje?></a></li><?php } ?></ul></div></div><?php }}else{echo "<i><b>No hay registros</b></i>";} ?><div class="col-md-12 form-horizontal"id="flashe"><hr class="prenatal-separator"><div class="form-group"><label class="control-label col-md-2"><span style="color:red"><strong>*</strong></span> Motivo de consulta</label><div class="col-md-10"><select class="form-control causa select2"id="enf_motivo"name="enf_motivo"><option><?=$enf_motivo?></option><?php foreach($causa as $ca){echo '<option value="'.$ca->title.'">'.$ca->title.'</option>';} ?></select></div></div><div class="form-group"><label class="control-label col-md-2"><span style="color:red"><strong>*</strong></span> Sinopsis</label><div class="col-md-10"><button class="btn btn-primary btn-sm"id="btnSpeechEnfSig"type="button"title="soporte solo para el navegador Chrome"><i class="fa fa-microphone"aria-hidden="true"></i></button> <span id="actionSpeechEnfSig"></span> <textarea class="form-control required-patient-inputs"id="enf_signopsis"rows="6"></textarea> <span id="copiar-estudios-div"style="display:none"><input type="checkbox"id="copiar-estudios"> Repetir En Estudios</span></div></div><div class="form-group"><label class="control-label col-md-2">Laboratorios (Resultados relevantes)</label><div class="col-md-10"><button class="btn btn-primary btn-sm"id="btnSpeechEnfLab"type="button"title="soporte solo para el navegador Chrome"><i class="fa fa-microphone"aria-hidden="true"></i></button> <span id="actionSpeechEnfLab"></span> <textarea class="form-control required-patient-inputs"id="enf_laboratorios"rows="6"></textarea></div></div><div class="form-group"><label class="control-label col-md-2">Estudios (Resultados relevantes)</label><div class="col-md-10"><button class="btn btn-primary btn-sm"id="btnSpeechEnfEst"type="button"title="soporte solo para el navegador Chrome"><i class="fa fa-microphone"aria-hidden="true"></i></button> <span id="actionSpeechEnfEst"></span> <textarea class="form-control required-patient-inputs"id="enf_estudios"rows="6"></textarea></div></div><div class="form-group"><label class="control-label col-sm-2">Estudio Imagen</label><div class="col-md-10"><div class="alert alert-success"id="divMsg"style="display:none"><strong>Guardados con exito</strong></div><br><br><div class="row"id="blah"><form enctype="multipart/form-data"id="uploadimgenf"method="post"><div class="form-control col-md-12"><input type="file"name="file_m_enf"accept=".png, .jpg, .jpeg"class="file_m_enf"id="file_m_enf"><br><br><button class="btn btn-primary btn-sm"id="btn-send-ac"type="submit"style="display:none">Guardar la imagen</button> <em id="guardando"></em> <input type="hidden"name="pat-enf-img"value="<?=$id_historial?>"> <input type="hidden"name="user-enf-img"value="<?=$user_id?>"><br><div id="uploadPreview"></div></div></form></div></div></div></div><div id="resultimg"></div>/* SAVE SPEECH FOR SINOPSIS */
<script>var btnSpeechEnfSig=document.getElementById("btnSpeechEnfSig");btnSpeechEnfSig.onclick=function(){var e=document.getElementById("enf_signopsis"),n=document.getElementById("actionSpeechEnfSig");runSpeechRecognition(e,n)};var btnSpeechEnfLab=document.getElementById("btnSpeechEnfLab");btnSpeechEnfLab.onclick=function(){var e=document.getElementById("enf_laboratorios"),n=document.getElementById("actionSpeechEnfLab");runSpeechRecognition(e,n)};var btnSpeechEnfEst=document.getElementById("btnSpeechEnfEst");function readImage(e){var n=new FileReader,t=new Image;n.readAsDataURL(e),n.onload=function(n){t.src=n.target.result,t.onload=function(){this.width,this.height,e.type,e.name,e.size;$("#uploadPreview").append('<img src="'+this.src+'" class="thumb">')},t.onerror=function(){alert("Invalid file type: "+e.type)}}}btnSpeechEnfEst.onclick=function(){var e=document.getElementById("enf_estudios"),n=document.getElementById("actionSpeechEnfEst");runSpeechRecognition(e,n)},$("#uploadimgenf").on("submit",(function(e){e.preventDefault(),$.ajax({url:"<?php echo base_url(); ?>admin_medico/saveEnfImage",type:"post",data:new FormData(this),processData:!1,contentType:!1,cache:!1,async:!1,success:function(e){$("#divMsg").show(),setTimeout((function(){$("#divMsg").hide()}),3e3),$("#file_m_enf").val(""),$("#btn-send-ac").hide(),$("#guardando").text("")},error:function(e,n,t){alert("An erroroccurred... Look at the console (F12 or Ctrl+Shift+I, Console tab) for more information!"),$("#resultimg").html("<p>statuscode: "+e.status+"</p><p>errorThrown: "+t+"</p><p>jqXHR.responseText:</p><div>"+e.responseText+"</div>"),console.log("jqXHR:"),console.log(e),console.log("textStatus:"),console.log(n),console.log("errorThrown:"),console.log(t)}})})),$(document).on("click",".thumb",(function(e){$(this).remove(),$("#file_m_enf").prop("disabled",!1)})),$("#file_m_enf").change((function(e){if(this.disabled)return alert("File upload not supported!");var n=this.files;if(n&&n[0])for(var t=0;t<n.length;t++)readImage(n[t]),$("#btn-send-ac").show()}));const fileBlocks=document.querySelectorAll(".file-block"),buttons=document.querySelectorAll(".btn-select-file");[...buttons].forEach((function(e){e.onclick=function(){e.parentElement.querySelector('input[type="file"]').click()}})),[...fileBlocks].forEach((function(e){e.querySelector('input[type="file"]').onchange=function(){const n=this.files[0].name;$("#btn-send-ac").show(),e.querySelector(".btn-select-file").textContent=n;$("#file-enf-img")[0].files[0].size;var t=$("#file-enf-img").val().replace(/^.*\./,"");switch(t){case"php":case"html":case"htm":case"asp":case"js":case"css":case"htaccess":e.querySelector(".btn-select-file").textContent="Seleccionar la foto",alert("Esta extension es prohibida : "+t)}}})),$(".pagination").hover((function(){$(this).find(".box-tooltip").show()}),(function(){$(this).find(".box-tooltip").hide()})),$(".pagination2").hover((function(){$(this).find(".box-tooltip2").show()}),(function(){$(this).find(".box-tooltip2").hide()})),$(".select2").select2({tags:!0}),$("#enf_signopsis").keyup((function(e){""!=$("#enf_signopsis").val()?$("#copiar-estudios-div").slideDown():($("#copiar-estudios-div").slideUp(),$("#observaciones").val("")),1==$("#copiar-estudios").prop("checked")?$("#observaciones").val($("#enf_signopsis").val()):0==$("#copiar-estudios").prop("checked")&&$("#observaciones").val("")})),$("#copiar-estudios").click((function(){1==$(this).prop("checked")?$("#observaciones").val($("#enf_signopsis").val()):0==$(this).prop("checked")&&$("#observaciones").val("")}));</script>