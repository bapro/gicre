<div class="modal-header"id="background_"><button class="close"type="button"title="Cierra"aria-hidden="true"data-dismiss="modal"><i class="fa fa-times-circle"style="font-size:48px;color:red"></i></button><h3 class="h3 his_med_title">Reporte General</h3></div><div class="modal-body"id="background_"><div class="container"style="height:600px;overflow-y:scroll"><div class="row"><div id="paginationNumberReport"></div><hr class="prenatal-separator"><button class="btn btn-primary btn-xs"id="nuevo-formr">NUEVO REGISTRO</button><hr class="prenatal-separator"><div id="contentrp"></div><div id="hide-form-cirugia-reporte"><form class="form-horizontal"method="post"><input id="id_enf"type="hidden"value="0"> <input id="id_con"type="hidden"value="0"><div class="form-group"><label class="col-sm-2 control-label"><span style="color:red">*</span> REPORTE:</label><div class="col-sm-5"><select class="form-control select2"id="cirugia_reporte"><option></option><?php $sql="SELECT name FROM hc_cirugia_name order by id ASC";$query=$this->db->query($sql);foreach($query->result()as $row){echo "<option >".$row->name."</option>";} ?></select></div><div class="col-sm-2"><button class="btn btn-primary btn-xs"id="add-hist-actual"type="button"><span class="glyphicon glyphicon-plus-sign"></span> Historia Actual</button></div></div><div class="form-group" style="display:none" id="show-days-contents"><label class="control-label col-sm-4">Se recomienda:</label><div class="col-sm-3"><div class="input-group"><input type="number" class="form-control" id="days_amount" placeholder="cuantos día?"><span class="input-group-addon"><span id="day_text">días</span> de reposo</span></div></div></div><div class="form-group"><label class="col-sm-2 control-label">DETALLE:</label><div class="col-sm-8"><div id="historial-actual-data"></div><br><button class="btn btn-primary btn-sm"id="btnRpG"type="button"title="soporte solo para el navegador Chrome"><i class="fa fa-microphone"aria-hidden="true"></i></button> <span id="actionSpeechRpG"></span> <textarea class="form-control clear-cirugia-toracia ckeditor"id="cirugia_detalle"rows="12"></textarea></div></div><div class="form-group"><div class="col-sm-9 col-sm-offset-2"><button class="btn btn-md btn-success"id="save-cirugia-reporte"type="button"><i class="fa after-action fa-check"style="display:none;color:#00f;font-size:30px;position:absolute"></i> GUARDAR</button> <a class="btn btn-primary btn-md imprimir-cirugia-reporte"href="<?php echo base_url("printings/print_if_foto_c/c_t_0/$id_historial/$user_id/$centro_medico/r") ?>"style="display:none"target="_blank"><i class="fa fa-print"></i> Imprimir Vert.</a> <a class="btn btn-primary btn-md imprimir-cirugia-reporte"href="<?php echo base_url("printings/print_if_foto_c1/c_t_0_/$id_historial/$user_id/$centro_medico/r") ?>"style="display:none"target="_blank"><i class="fa fa-print"></i> Imprimir Horiz.</a></div></div></form></div></div></div></div><script>var btnRpG=document.getElementById("btnRpG");function addHistAct(){$("#save-cirugia-reporte").prop("disabled",!0),$.ajax({url:"<?php echo base_url(); ?>historialHeader/addHistAct",data:{id_user:<?=$user_id?>,id_patient:<?=$id_historial?>,centro:<?=$centro_medico?>},method:"POST",success:function(e){$("#historial-actual-data").html(e)},error:function(e,i,r){alert("An error occurred... Look at the console (F12 or Ctrl+Shift+I, Console tab) for more information!"),$("#paginationNumberReport").html("<p>status code: "+e.status+"</p><p>errorThrown: "+r+"</p><p>jqXHR.responseText:</p><div>"+e.responseText+"</div>"),console.log("jqXHR:"),console.log(e),console.log("textStatus:"),console.log(i),console.log("errorThrown:"),console.log(r)}})}function assignIdEnfToReporte(){$.ajax({url:"<?php echo base_url(); ?>historialHeader/assignIdEnfToReporte",data:{id_user:<?=$user_id?>,id_patient:<?=$id_historial?>,centro:<?=$centro_medico?>},method:"POST",success:function(e){$("#id_enf").val(e)}})}function assignIdConToReporte(){$.ajax({url:"<?php echo base_url(); ?>historialHeader/assignIdConToReporte",data:{id_user:<?=$user_id?>,id_patient:<?=$id_historial?>,centro:<?=$centro_medico?>},method:"POST",success:function(e){$("#id_con").val(e),$("#save-cirugia-reporte").prop("disabled",!1)}})}function paginationNumberReport(){$.ajax({url:"<?php echo base_url(); ?>historialHeader/paginationNumberReport",data:{id_user:<?=$user_id?>,id_patient:<?=$id_historial?>,centro_medico:<?=$centro_medico?>},method:"POST",success:function(e){$("#paginationNumberReport").html(e)}})}btnRpG.onclick=function(){var e=document.getElementById("cirugia_detalle"),i=document.getElementById("actionSpeechRpG");runSpeechRecognition(e,i)},$("#add-hist-actual").on("click",function(e){e.preventDefault(),addHistAct(),assignIdEnfToReporte(),assignIdConToReporte()}),$(".select2").select2({tags:!0}),paginationNumberReport(),$("#save-cirugia-reporte").on("click",function(e){e.preventDefault();var i=$("#cirugia_detalle").val(),r=$("#cirugia_reporte").val(),n=$("#id_enf").val(),d=$("#days_amount").val(),u=$("#id_con").val();""!=r&&($("#save-cirugia-reporte").prop("disabled",!0),$("#save-cirugia-reporte").text("guardando..."),$.ajax({url:"<?php echo base_url(); ?>historialHeader/saveCirugiaReporte",data:{cirugia_reporte:r.trim(),cirugia_detalle:i,id_enf:n,id_con:u,days_amount:d,id_cirugia_toracia_rep:0,id_user:<?=$user_id?>,id_patient:<?=$id_historial?>,centro:<?=$centro_medico?>},method:"POST",success:function(e){paginationNumberReport(),$(".after-actionp").fadeIn("slow",function(){$(".after-actionp").delay(3e3).fadeOut()}),$(".imprimir-cirugia-reporte").show(),$("#save-cirugia-reporte").text("GUARDAR"),$("#save-cirugia-reporte").prop("disabled",!1)}}))}),$('#cirugia_reporte').on('change',function(event){event.preventDefault();if($(this).val()=="LICENCIA MEDICA"){$("#show-days-contents").show()}else{$("#show-days-contents").hide(),$("#cirugia_detalle").val(""),$('#days_amount').val("")}});var timer=null;function dayAmount(){if(""!=$("#days_amount").val()){1==$("#days_amount").val()?$("#day_text").text("d\xeda"):$("#day_text").text("d\xedas");var a="Se recomienda "+$("#days_amount").val()+" "+$("#day_text").text()+" de reposo.\r\n";$("#cirugia_detalle").val(a).focus()}else $("#cirugia_detalle").val("")}$("#days_amount").on("input",function(a){a.preventDefault(),clearTimeout(timer),timer=setTimeout(dayAmount,1e3)})</script>