<?php defined('BASEPATH')OR exit('No direct script access allowed');class HistorialHeader extends CI_Controller{public function __construct(){parent::__construct();$this->load->model('model_admin');}function reportHistorialMenu(){$user_id=$this->uri->segment(3);$data['user_id']=$user_id;$data['id_historial']=$this->uri->segment(4);$centro_medico= $this->uri->segment(5);$data['centro_medico']=$centro_medico;$data['centro']=$this->db->select('name')->where('id_m_c',$centro_medico)->get('medical_centers')->row('name');$rec=$this->uri->segment(6);if($rec==1){$this->load->view('admin/historial-medical1/cirugia_toracica/general/index',$data);}else if($rec==2){$this->load->view('admin/historial-medical1/cirugia_toracica/index',$data);}else if($rec==4){$this->load->view('admin/historial-medical1/ipss/index',$data);}else if($rec==5){$this->load->view('admin/historial-medical1/cardiovascular/index',$data);}else if($rec==6){$this->load->view('admin/historial-medical1/orden-medica/index',$data);}else if($rec==7){$this->load->view('admin/historial-medical1/trastorno-sueno/screening/index',$data);}else if($rec==8){$this->load->view('admin/historial-medical1/cirugia-plastica/sesion-foto/index',$data);}elseif($rec==9){$this->load->view('admin/historial-medical1/colposcopia/index',$data);}else{$data['centro_medico_data']=$this->model_admin->view_doctor_centro($user_id);$this->load->view('admin/historial-medical1/quirurgia/index',$data);}}function addHistAct(){$id_pat=$this->input->post('id_patient');$id_user=$this->input->post('id_user');$centro=$this->input->post('centro');$perfil=$this->db->select('perfil')->where('id_user',$id_user)->get('users')->row('perfil');if($perfil=="Admin"){$enfermedad=$this->db->select('enf_motivo,signopsis,laboratorios,estudios')->where('historial_id',$id_pat)->order_by('id_enf','desc')->get('h_c_sinopsis')->row_array();$cdia=$this->db->select('id_cdia,otros_diagnos,plan,procedimiento,evolucion')->where('historial_id',$id_pat)->order_by('id_cdia','desc')->get('h_c_conclusion_diagno')->row_array();$exam_fis=$this->db->select('*')->where('historial_id',$id_pat)->order_by('id_sig','desc')->get('h_c_examen_fisico')->row_array();$exam_sistema=$this->db->select('*')->where('historial_id',$id_pat)->order_by('id_exs','desc')->get('h_c_examen_sistema')->row_array();$query2=$this->db->get_where('h_c_examen_sistema',array('historial_id'=>$id_pat));$row_exam=$query2->num_rows();$query1=$this->db->get_where('h_c_examen_fisico',array('historial_id'=>$id_pat));$row_fis=$query1->num_rows();}else{$enfermedad=$this->db->select('enf_motivo,signopsis,laboratorios,estudios')->where('historial_id',$id_pat)->where('updated_by',$id_user)->order_by('id_enf','desc')->get('h_c_sinopsis')->row_array();$cdia=$this->db->select('id_cdia,otros_diagnos,plan,procedimiento,evolucion')->where('historial_id',$id_pat)->where('id_user',$id_user)->order_by('id_cdia','desc')->get('h_c_conclusion_diagno')->row_array();$exam_fis=$this->db->select('*')->where('historial_id',$id_pat)->where('id_user',$id_user)->order_by('id_sig','desc')->get('h_c_examen_fisico')->row_array();$exam_sistema=$this->db->select('*')->where('historial_id',$id_pat)->where('id_user',$id_user)->order_by('id_exs','desc')->get('h_c_examen_sistema')->row_array();$query2=$this->db->get_where('h_c_examen_sistema',array('historial_id'=>$id_pat,'id_user'=>$id_user));$row_exam=$query2->num_rows();$query1=$this->db->get_where('h_c_examen_fisico',array('historial_id'=>$id_pat,'id_user'=>$id_user));$row_fis=$query1->num_rows();}$musculoes=$exam_sistema['musculoes'];$sisneuro=$exam_sistema['sisneuro'];$neurologico=$exam_sistema['neurologico'];$siscardio=$exam_sistema['siscardio'];$cardiova=$exam_sistema['cardiova'];$urogenital=$exam_sistema['urogenital'];$sis_mu_e=$exam_sistema['sist_uro'];$sist_uro=$exam_sistema['sis_mu_e'];$sist_resp=$exam_sistema['sist_resp'];$nervioso=$exam_sistema['nervioso'];$linfatico=$exam_sistema['linfatico'];$digestivo=$exam_sistema['digestivo'];$respiratorio=$exam_sistema['respiratorio'];$genitourinario=$exam_sistema['genitourinario'];$sist_diges=$exam_sistema['sist_diges'];$sist_endo=$exam_sistema['sist_endo'];$endocrino=$exam_sistema['endocrino'];$sist_rela=$exam_sistema['sist_rela'];$otros_ex_sis=$exam_sistema['otros_ex_sis'];$dorsales=$exam_sistema['dorsales'];$peso=$exam_fis['peso'];$kg=$exam_fis['kg'];$talla=$exam_fis['talla'];$imc=$exam_fis['imc'];$cuello_text=$exam_fis['cuello_text'];$ext_sup_text=$exam_fis['ext_sup_text'];$ext_inft=$exam_fis['ext_inft'];$torax_text=$exam_fis['torax_text'];$motivo=$enfermedad['enf_motivo'];$signopsis=$enfermedad['signopsis'];$laboratorios=$enfermedad['laboratorios'];$estudios=$enfermedad['estudios'];$id_cdia=$cdia['id_cdia'];if($id_cdia!=''){echo "<strong>ENFERMEDAD ACTUAL</strong>";echo "<ul>";echo"<li>$motivo</li>";echo"<li>$signopsis</li>";if($laboratorios!=""){echo"<li>$laboratorios</li>";}if($estudios!=""){echo"<li>$estudios</li>";}echo "</ul>";$otros=$cdia['otros_diagnos'];$plan=$cdia['plan'];$procedimiento=$cdia['procedimiento'];$evolucion=$cdia['evolucion'];$sql="SELECT diagno_def FROM  h_c_diagno_def_link WHERE con_id_link=$id_cdia";$querysig=$this->db->query($sql);if($querysig->result()!=NULL){echo "<strong>CONCLUSION DIAGNOSTICOS</strong>";echo "<ul>";foreach($querysig->result()as $rf){$desc=$this->db->select('description')->where('idd',$rf->diagno_def)->get('cied')->row('description');echo"<li>$desc</li>";}echo "</ul>";}if($otros!=''){echo "<strong>OTROS DIAGNOSTICOS</strong>";echo "<ul>";echo"<li>$otros</li>";echo "</ul>";}if($plan!=''){echo "<strong>PLAN</strong>";echo "<ul>";echo"<li>$plan</li>";echo "</ul>";}if($procedimiento!=''){echo "<strong>PROCEDIMIENTO</strong>";echo "<ul>";echo"<li>$procedimiento</li>";echo "</ul>";}if($evolucion!=''){echo "<strong>EVOLUCION</strong>";echo "<ul>";echo"<li>$evolucion</li>";echo "</ul>";}if($row_fis>0){echo "<strong>EXAMEN FISICO</strong><br/>";if($peso!=0){echo"<strong>Peso</strong> $peso - <strong>Kg</strong> $kg <br/>";}if($talla!=""){echo" <strong>Talla</strong> $talla";}if($imc!=""){echo" <strong>IMC</strong> $imc";}if($cuello_text!=""){echo"<strong>Cuello</strong> $cuello_text <br/>";}if($ext_sup_text!=""){echo"<strong>Extremidades Superiores</strong> $ext_sup_text <br/>";}if($ext_inft!=""){echo"<strong>Extremidades Inferiores</strong> $ext_inft <br/>";}if($torax_text!=""){echo"<strong>Torax Corazón y pulmones</strong> $torax_text<br/>";}}if($row_exam>0){echo "<strong>EXAMEN SISTEMA</strong><br/>";if($neurologico!=""){echo"<strong>Sistema neurológico</strong> $neurologico<br/>";}if($cardiova!=""){echo"<strong>Sistema cardiovascular</strong> $cardiova<br/>";}if($urogenital!=""){echo"<strong>Sistema urogenital</strong> $urogenital<br/>";}if($nervioso!=""){echo"<strong>Sistema nervioso</strong> $nervioso<br/>";}if($linfatico!=""){echo"<strong>Sistema linfatico</strong> $linfatico<br/>";}if($respiratorio!=""){echo"<strong>Sistema respiratorio</strong> $respiratorio<br/>";}if($genitourinario!=""){echo"<strong>Sistema genitourinario</strong> $genitourinario<br/>";}if($digestivo!=""){echo"<strong>Sistema digestivo</strong> $digestivo<br/>";}if($endocrino!=""){echo"<strong>Sistema endocrino</strong> $endocrino<br/>";}if($otros_ex_sis!=""){echo"<strong>Relativo a</strong> $otros_ex_sis<br/>";}if($dorsales!=""){echo"<strong>Columna dorsal</strong> $dorsales<br/>";}if($musculoes!=""){echo"<strong>Sistema músculo esquelético</strong> $musculoes";}}}else{echo "<span style='color:red'>Lo siento no lo podemos mostrar...</span>";}}function assignIdEnfToReporte(){$id_pat=$this->input->post('id_patient');$id_user=$this->input->post('id_user');$centro=$this->input->post('centro');$perfil=$this->db->select('perfil')->where('id_user',$id_user)->get('users')->row('perfil');if($perfil=="Admin"){$id_enf=$this->db->select('id_enf')->where('historial_id',$id_pat)->order_by('id_enf','desc')->get('h_c_sinopsis')->row('id_enf');}else{$id_enf=$this->db->select('id_enf')->where('historial_id',$id_pat)->where('updated_by',$id_user)->order_by('id_enf','desc')->get('h_c_sinopsis')->row('id_enf');}if($id_enf!=''){echo $id_enf;}else{echo 0;}}function assignIdConToReporte(){$id_pat=$this->input->post('id_patient');$id_user=$this->input->post('id_user');$centro=$this->input->post('centro');$perfil=$this->db->select('perfil')->where('id_user',$id_user)->get('users')->row('perfil');if($perfil=="Admin"){$id_con=$this->db->select('id_cdia')->where('historial_id',$id_pat)->order_by('id_cdia','desc')->get('h_c_conclusion_diagno')->row('id_cdia');}else{$id_con=$this->db->select('id_cdia')->where('historial_id',$id_pat)->where('id_user',$id_user)->order_by('id_cdia','desc')->get('h_c_conclusion_diagno')->row('id_cdia');}if($id_con!=''){echo $id_con;}else{echo 0;}}function paginationNumberReport(){$data['user_id']=$this->input->post('id_user');$data['centro_medico']=$this->input->post('centro_medico');$data['id_historial']=$this->input->post('id_patient');$data['perfil']=$this->db->select('perfil')->where('id_user',$this->input->post('id_user'))->get('users')->row('perfil');$this->load->view('admin/historial-medical1/cirugia_toracica/general/pagination-number',$data);}function saveCirugiaReporte(){$query=$this->db->get_where('hc_cirugia_name',array('name'=>$this->input->post('cirugia_reporte')));if($query->num_rows()==0){$savename=array('name'=>$this->input->post('cirugia_reporte'));$this->db->insert("hc_cirugia_name",$savename);}$save=array('days_amount'=> $this->input->post('days_amount'),'detalle'=>$this->input->post('cirugia_detalle'),'reporte'=>$this->input->post('cirugia_reporte'),'id_user'=>$this->input->post('id_user'),'id_patient'=>$this->input->post('id_patient'),'id_enf'=>$this->input->post('id_enf'),'id_cond'=>$this->input->post('id_con'),'id_centro'=> $this->input->post('centro'),'inserted_time'=>date("Y-m-d H:i:s"));if($this->input->post('id_cirugia_toracia_rep')==0){$this->db->insert("hc_cirugia_reporte",$save);}else{$change_time=date("Y-m-d H:i:s",strtotime($this->input->post('fecha')));$data=array('detalle'=>$this->input->post('cirugia_detalle'),'reporte'=>$this->input->post('cirugia_reporte'),'inserted_time'=>$change_time);$where=array('id'=>$this->input->post('id_cirugia_toracia_rep'));$this->db->where($where);$this->db->update("hc_cirugia_reporte",$data);}}function pagination_data_cirugia_general(){$page=$this->input->get('page');$user_id=$this->input->get('user_id');$id_patient=$this->input->get('id_patient');$perfil=$this->input->get('perfil');if($perfil=="Admin"){$contition="";}else{$contition="id_user=$user_id AND";}$data['id_patient']=$id_patient;$data['user_id']=$user_id;$data['centro_medico']=$this->input->get('centro_medico');$data['page']=$page;$per_page=1;$start=($page-1)*$per_page;$sql="select * from hc_cirugia_reporte where id=$page";$data['cirugia_paginate']=$this->db->query($sql);$this->load->view('admin/historial-medical1/cirugia_toracica/general/paginate',$data);}function showCirugiaTabulation(){$data['user_id']=$this->input->post('id_user');$data['centro_medico']=$this->input->post('centro_medico');$data['id_historial']=$this->input->post('id_patient');$data['perfil']=$this->db->select('perfil')->where('id_user',$this->input->post('id_user'))->get('users')->row('perfil');$this->load->view('admin/historial-medical1/cirugia_toracica/pagination-number',$data);}function cirugiaToracia(){$insert_date=date("Y-m-d H:i:s");$cepillado_bronquial=$this->input->post('cepillado_bronquial');$cep_b=(isset($cepillado_bronquial))?1:0;$lavado_bronco=$this->input->post('lavado_bronco');$lavado_b=(isset($lavado_bronco))?1:0;$broncoas=$this->input->post('broncoas');$bron=(isset($broncoas))?1:0;$biopsia_bronq=$this->input->post('biopsia_bronq');$biop_br=(isset($biopsia_bronq))?1:0;$biopsia_tras=$this->input->post('biopsia_tras');$bio_t=(isset($biopsia_tras))?1:0;$puncion_tras=$this->input->post('puncion_tras');$pun_t=(isset($puncion_tras))?1:0;$save=array('hora_inicio'=>$this->input->post('hora_inicio'),'hora_final'=>$this->input->post('hora_final'),'diag_pre_fbc'=>$this->input->post('diag_pre_fbc'),'svta'=>$this->input->post('svta'),'mmhg'=>$this->input->post('mmhg'),'minfr'=>$this->input->post('minfr'),'resmin'=>$this->input->post('resmin'),'tacir'=>$this->input->post('tacir'),'fccir'=>$this->input->post('fccir'),'frcir'=>$this->input->post('frcir'),'sato2'=>$this->input->post('sato2'),'fosas_nasales'=>$this->input->post('fosas_nasales'),'cuerdad_bocales'=>$this->input->post('cuerdad_bocales'),'traqua_text'=>$this->input->post('traqua_text'),'carina_text'=>$this->input->post('carina_text'),'bronquio_principal'=>$this->input->post('bronquio_principal'),'bronquio_prince_iz'=>$this->input->post('bronquio_prince_iz'),'lsi_lii'=>$this->input->post('lsi_lii'),'cepillado_bronquial'=>$cep_b,'lavado_bronco'=>$lavado_b,'broncoas'=>$bron,'biopsia_bronq'=>$biop_br,'biopsia_tras'=>$bio_t,'puncion_tras'=>$pun_t,'complic_text'=>$this->input->post('complic_text'),'diag_post_fbc'=>$this->input->post('diag_post_fbc'),'lsd_lm'=>$this->input->post('lsd_lm'),'user'=>$this->input->post('id_user'),'id_patient'=>$this->input->post('id_patient'),'inserted_time'=>$insert_date);if($this->input->post('id_cirugia_toracia')==0){$this->db->insert("hc_cirugia_toracica",$save);}else{$data=array('hora_inicio'=>$this->input->post('hora_inicio'),'hora_final'=>$this->input->post('hora_final'),'diag_pre_fbc'=>$this->input->post('diag_pre_fbc'),'svta'=>$this->input->post('svta'),'mmhg'=>$this->input->post('mmhg'),'minfr'=>$this->input->post('minfr'),'resmin'=>$this->input->post('resmin'),'tacir'=>$this->input->post('tacir'),'fccir'=>$this->input->post('fccir'),'frcir'=>$this->input->post('frcir'),'sato2'=>$this->input->post('sato2'),'fosas_nasales'=>$this->input->post('fosas_nasales'),'cuerdad_bocales'=>$this->input->post('cuerdad_bocales'),'traqua_text'=>$this->input->post('traqua_text'),'carina_text'=>$this->input->post('carina_text'),'bronquio_principal'=>$this->input->post('bronquio_principal'),'bronquio_prince_iz'=>$this->input->post('bronquio_prince_iz'),'lsi_lii'=>$this->input->post('lsi_lii'),'cepillado_bronquial'=>$cep_b,'lavado_bronco'=>$lavado_b,'broncoas'=>$bron,'biopsia_bronq'=>$biop_br,'biopsia_tras'=>$bio_t,'puncion_tras'=>$pun_t,'complic_text'=>$this->input->post('complic_text'),'diag_post_fbc'=>$this->input->post('diag_post_fbc'),'lsd_lm'=>$this->input->post('lsd_lm'),);$where=array('id'=>$this->input->post('id_cirugia_toracia'));$this->db->where($where);$this->db->update("hc_cirugia_toracica",$data);}}function pagination_data_cirugia_toracica(){$page=$this->input->get('page');$user_id=$this->input->get('user_id');$id_patient=$this->input->get('id_patient');$data['id_patient']=$id_patient;$data['user_id']=$user_id;$perfil=$this->input->get('perfil');if($perfil=="Admin"){$contition="";}else{$contition="user=$user_id AND";}$data['centro_medico']=$this->input->get('centro_medico');$data['page']=$page;$per_page=1;$start=($page-1)*$per_page;$sql="select * from hc_cirugia_toracica where id=$page";$data['cirugia_paginate']=$this->db->query($sql);$this->load->view('admin/historial-medical1/cirugia_toracica/paginate',$data);}function paginationIpss(){$data['user_id']=$this->input->post('id_user');$data['centro_medico']=$this->input->post('centro_medico');$data['id_historial']=$this->input->post('id_patient');$data['perfil']=$this->db->select('perfil')->where('id_user',$this->input->post('id_user'))->get('users')->row('perfil');$this->load->view('admin/historial-medical1/ipss/pagination-number',$data);}function saveIPPS(){$save=array('tr1_0'=>$this->input->post('tr1_0'),'tr2_1'=>$this->input->post('tr2_1'),'tr3_2'=>$this->input->post('tr3_2'),'tr4_3'=>$this->input->post('tr4_3'),'tr5_4'=>$this->input->post('tr5_4'),'tr6_5'=>$this->input->post('tr6_5'),'tr7_6'=>$this->input->post('tr7_6'),'tr8'=>$this->input->post('tr8'),'historial_id'=>$this->input->post('histoirial_id'),'inserted_by'=>$this->input->post('id_user'),'updated_by'=>$this->input->post('id_user'),'inserted_time'=>date("Y-m-d H:i:s"),'updated_time'=>date("Y-m-d H:i:s"),'id_user'=>$this->input->post('id_user'),'result'=>$this->input->post('result'),'ipsscolor'=>$this->input->post('ipsscolor'));if($this->input->post('idipss')==0){$this->db->insert("h_c_ipss",$save);}else{$data=array('tr1_0'=>$this->input->post('tr1_0'),'tr2_1'=>$this->input->post('tr2_1'),'tr3_2'=>$this->input->post('tr3_2'),'tr4_3'=>$this->input->post('tr4_3'),'tr5_4'=>$this->input->post('tr5_4'),'tr6_5'=>$this->input->post('tr6_5'),'tr7_6'=>$this->input->post('tr7_6'),'tr8'=>$this->input->post('tr8'),'updated_by'=>$this->input->post('id_user'),'updated_time'=>date("Y-m-d H:i:s"),'result'=>$this->input->post('result'),'ipsscolor'=>$this->input->post('ipsscolor'));$where=array('id'=>$this->input->post('idipss'));$this->db->where($where);$this->db->update("h_c_ipss",$data);}}function pagination_data_ipss(){$page=$this->input->get('page');$user_id=$this->input->get('user_id');$id_patient=$this->input->get('id_patient');$perfil=$this->input->get('perfil');if($perfil=="Admin"){$contition="";}else{$contition="id_user=$user_id AND";}$data['id_patient']=$id_patient;$data['user_id']=$user_id;$data['centro_medico']=$this->input->get('centro_medico');$data['page']=$page;$per_page=1;$start=($page-1)*$per_page;$sql="select * from h_c_ipss where id=$page";$data['ipss_paginate']=$this->db->query($sql);$this->load->view('admin/historial-medical1/ipss/paginate',$data);}function showCardioVas(){$data['user_id']=$this->input->post('id_user');$data['centro_medico']=$this->input->post('centro_medico');$data['id_historial']=$this->input->post('id_patient');$data['perfil']=$this->db->select('perfil')->where('id_user',$this->input->post('id_user'))->get('users')->row('perfil');$this->load->view('admin/historial-medical1/cardiovascular/pagination-number',$data);}function saveEvCard(){$sin_car_dol_tor=$this->input->post('sin_car_dol_tor');$sin_car_dol_tor1=(isset($sin_car_dol_tor))?1:0;$sin_car_dis=$this->input->post('sin_car_dis');$sin_car_dis1=(isset($sin_car_dis))?1:0;$sin_car_tos=$this->input->post('sin_car_tos');$sin_car_tos1=(isset($sin_car_tos))?1:0;$sin_car_palp=$this->input->post('sin_car_palp');$sin_car_palp1=(isset($sin_car_palp))?1:0;$sin_car_ort=$this->input->post('sin_car_ort');$sin_car_ort1=(isset($sin_car_ort))?1:0;$sin_car_edem=$this->input->post('sin_car_edem');$sin_car_edem1=(isset($sin_car_edem))?1:0;$sin_car_otro=$this->input->post('sin_car_otro');$sin_car_otro1=(isset($sin_car_otro))?1:0;$save=array('tipo_cirugia'=>$this->input->post('tipo_cirugia'),'cirugia_ant'=>$this->input->post('cirugia_ant'),'riesgo_qui_alto'=>$this->input->post('riesgo_qui_alto'),'inserted_by'=>$this->input->post('inserted_by'),'inserted_time'=>date('Y-m-d H:i:s'),'patient'=>$this->input->post('patient'),'id_user'=>$this->input->post('inserted_by'),'riesgo_qui_medio'=>$this->input->post('riesgo_qui_medio'),'riesgo_qui_bajo'=>$this->input->post('riesgo_qui_bajo'),'ant_card_radio1'=>$this->input->post('ant_card_radio1'),'ant_card_radio2'=>$this->input->post('ant_card_radio2'),'ant_card_radio3'=>$this->input->post('ant_card_radio3'),'ant_card_radio4'=>$this->input->post('ant_card_radio4'),'ant_card_radio5'=>$this->input->post('ant_card_radio5'),'ant_card_radio6'=>$this->input->post('ant_card_radio6'),'text_ant_card1'=>$this->input->post('text_ant_card1'),'text_ant_card2'=>$this->input->post('text_ant_card2'),'text_ant_card3'=>$this->input->post('text_ant_card3'),'text_ant_card4'=>$this->input->post('text_ant_card4'),'text_ant_card5'=>$this->input->post('text_ant_card5'),'text_ant_card6'=>$this->input->post('text_ant_card6'),'cond_com_ta'=>$this->input->post('cond_com_ta'),'cond_com_ob'=>$this->input->post('cond_com_ob'),'cond_com_an'=>$this->input->post('cond_com_an'),'cond_com_hep'=>$this->input->post('cond_com_hep'),'cond_com_disc'=>$this->input->post('cond_com_disc'),'cond_com_diab'=>$this->input->post('cond_com_diab'),'cond_com_disf'=>$this->input->post('cond_com_disf'),'cond_com_enfvas'=>$this->input->post('cond_com_enfvas'),'cond_com_peri'=>$this->input->post('cond_com_peri'),'cond_com_enfcr'=>$this->input->post('cond_com_enfcr'),'cond_com_acv'=>$this->input->post('cond_com_acv'),'cond_com_asbr'=>$this->input->post('cond_com_asbr'),'cond_com_otras'=>$this->input->post('cond_com_otras'),'cap_fun_lim'=>$this->input->post('cap_fun_lim'),'cap_fun_bue'=>$this->input->post('cap_fun_bue'),'sin_car_dol_tor'=>$sin_car_dol_tor1,'sin_car_dis'=>$sin_car_dis1,'sin_car_tos'=>$sin_car_tos1,'sin_car_palp'=>$sin_car_palp1,'sin_car_ort'=>$sin_car_ort1,'sin_car_edem'=>$sin_car_edem1,'sin_car_otro'=>$sin_car_otro1,'sin_car_otro_txt'=>$this->input->post('sin_car_otro_txt'),'exam_fis_bd'=>$this->input->post('exam_fis_bd'),'exam_fis_bi'=>$this->input->post('exam_fis_bi'),'exam_fis_ivy'=>$this->input->post('exam_fis_ivy'),'exam_fis_torax'=>$this->input->post('exam_fis_torax'),'exam_fis_coraz'=>$this->input->post('exam_fis_coraz'),'exam_fis_pulm'=>$this->input->post('exam_fis_pulm'),'exam_fis_abdom'=>$this->input->post('exam_fis_abdom'),'exam_fis_miemb'=>$this->input->post('exam_fis_miemb'),'exam_fis_rhy'=>$this->input->post('exam_fis_rhy'),'exam_fis_edema'=>$this->input->post('exam_fis_edema'),'lab_hcto'=>$this->input->post('lab_hcto'),'lab_hb'=>$this->input->post('lab_hb'),'lab_gb'=>$this->input->post('lab_gb'),'lab_plaq'=>$this->input->post('lab_plaq'),'lab_creat'=>$this->input->post('lab_creat'),'lab_glice'=>$this->input->post('lab_glice'),'lab_tgo'=>$this->input->post('lab_tgo'),'lab_tgo_tgp'=>$this->input->post('lab_tgo_tgp'),'lab_tgo_ts_tc'=>$this->input->post('lab_tgo_ts_tc'),'lab_tp'=>$this->input->post('lab_tp'),'lab_tpt'=>$this->input->post('lab_tpt'),'lab_orina'=>$this->input->post('lab_orina'),'res_car_elec'=>$this->input->post('res_car_elec'),'res_car_rad_tor'=>$this->input->post('res_car_rad_tor'),'res_car_eco'=>$this->input->post('res_car_eco'),'res_car_hol'=>$this->input->post('res_car_hol'),'res_car_esperim'=>$this->input->post('res_car_esperim'),'res_car_mapa'=>$this->input->post('res_car_mapa'),'con_diag_pat_car_del'=>$this->input->post('con_diag_pat_car_del'),'con_diag_otros_pat'=>$this->input->post('con_diag_otros_pat'),'riesgo_car_menor'=>$this->input->post('riesgo_car_menor'),'riesgo_car_intermedio'=>$this->input->post('riesgo_car_intermedio'),'riesgo_car_mayor'=>$this->input->post('riesgo_car_mayor'),'riesgo_car_recomend'=>$this->input->post('riesgo_car_recomend'));$this->db->insert("hc_evaluacion_car_vas",$save);$id_cardio=$this->db->select('id')->order_by('id','desc')->limit(1)->get('hc_evaluacion_car_vas')->row('id');$saveex=array('peso'=>$this->input->post('cardio_peso'),'kg'=>$this->input->post('cardio_kg'),'talla'=>$this->input->post('cardio_talla'),'imc'=>$this->input->post('cardio_imc'),'ta'=>$this->input->post('cardio_ta'),'fr'=>$this->input->post('cardio_fr'),'fc'=>$this->input->post('cardio_fc'),'hg'=>$this->input->post('cardio_hg'),'tempo'=>$this->input->post('cardio_tempo'),'glicemia'=>$this->input->post('cardio_glicemia'),'pulso'=>$this->input->post('cardio_pulso'),'radio'=>$this->input->post('cardio_radio_signo'),'id_cardio'=>$id_cardio);$this->db->insert("h_c_examen_fisico",$saveex);}function loadSignoCard(){$data['edad']=$this->db->select('edad')->where('id_p_a',$this->input->post('patient'))->get('patients_appointments')->row('edad');$id_cardio=$this->input->post('id_cardio');$sql="select * from   h_c_examen_fisico  where id_cardio=$id_cardio";$data['cardiov_signo']=$this->db->query($sql);$this->load->view('admin/historial-medical1/cardiovascular/signo_result',$data);}function uptadeCarVas(){$sin_car_dol_tor=$this->input->post('ed_sin_car_dol_tor');$sin_car_dol_tor1=(isset($sin_car_dol_tor))?1:0;$sin_car_dis=$this->input->post('ed_sin_car_dis');$sin_car_dis1=(isset($sin_car_dis))?1:0;$sin_car_tos=$this->input->post('ed_sin_car_tos');$sin_car_tos1=(isset($sin_car_tos))?1:0;$sin_car_palp=$this->input->post('ed_sin_car_palp');$sin_car_palp1=(isset($sin_car_palp))?1:0;$sin_car_ort=$this->input->post('ed_sin_car_ort');$sin_car_ort1=(isset($sin_car_ort))?1:0;$sin_car_edem=$this->input->post('ed_sin_car_edem');$sin_car_edem1=(isset($sin_car_edem))?1:0;$sin_car_otro=$this->input->post('ed_sin_car_otro');$sin_car_otro1=(isset($sin_car_otro))?1:0;$data=array('updated_by'=>$this->input->post('updated_by'),'updated_time'=>date('Y-m-d H:i:s'),'riesgo_qui_alto'=>$this->input->post('ed_riesgo_qui_alto'),'riesgo_qui_medio'=>$this->input->post('ed_riesgo_qui_medio'),'riesgo_qui_bajo'=>$this->input->post('ed_riesgo_qui_bajo'),'ant_card_radio1'=>$this->input->post('ed_ant_card_radio1'),'tipo_cirugia'=>$this->input->post('ed_tipo_cirugia'),'cirugia_ant'=>$this->input->post('ed_cirugia_ant'),'riesgo_qui_alto'=>$this->input->post('ed_riesgo_qui_alto'),'riesgo_qui_medio'=>$this->input->post('ed_riesgo_qui_medio'),'riesgo_qui_bajo'=>$this->input->post('ed_riesgo_qui_bajo'),'ant_card_radio1'=>$this->input->post('ed_ant_card_radio1'),'ant_card_radio2'=>$this->input->post('ed_ant_card_radio2'),'ant_card_radio3'=>$this->input->post('ed_ant_card_radio3'),'ant_card_radio4'=>$this->input->post('ed_ant_card_radio4'),'ant_card_radio5'=>$this->input->post('ed_ant_card_radio5'),'ant_card_radio6'=>$this->input->post('ed_ant_card_radio6'),'text_ant_card1'=>$this->input->post('ed_text_ant_card1'),'text_ant_card2'=>$this->input->post('ed_text_ant_card2'),'text_ant_card3'=>$this->input->post('ed_text_ant_card3'),'text_ant_card4'=>$this->input->post('ed_text_ant_card4'),'text_ant_card5'=>$this->input->post('ed_text_ant_card5'),'text_ant_card6'=>$this->input->post('ed_text_ant_card6'),'cond_com_ta'=>$this->input->post('ed_cond_com_ta'),'cond_com_ob'=>$this->input->post('ed_cond_com_ob'),'cond_com_an'=>$this->input->post('ed_cond_com_an'),'cond_com_hep'=>$this->input->post('ed_cond_com_hep'),'cond_com_disc'=>$this->input->post('ed_cond_com_disc'),'cond_com_diab'=>$this->input->post('ed_cond_com_diab'),'cond_com_disf'=>$this->input->post('ed_cond_com_disf'),'cond_com_enfvas'=>$this->input->post('ed_cond_com_enfvas'),'cond_com_peri'=>$this->input->post('ed_cond_com_peri'),'cond_com_enfcr'=>$this->input->post('ed_cond_com_enfcr'),'cond_com_acv'=>$this->input->post('ed_cond_com_acv'),'cond_com_asbr'=>$this->input->post('ed_cond_com_asbr'),'cond_com_otras'=>$this->input->post('ed_cond_com_otras'),'cap_fun_lim'=>$this->input->post('ed_cap_fun_lim'),'cap_fun_bue'=>$this->input->post('ed_cap_fun_bue'),'sin_car_dol_tor'=>$sin_car_dol_tor1,'sin_car_dis'=>$sin_car_dis1,'sin_car_tos'=>$sin_car_tos1,'sin_car_palp'=>$sin_car_palp1,'sin_car_ort'=>$sin_car_ort1,'sin_car_edem'=>$sin_car_edem1,'sin_car_otro'=>$sin_car_otro1,'sin_car_otro_txt'=>$this->input->post('ed_sin_car_otro_txt'),'exam_fis_bd'=>$this->input->post('ed_exam_fis_bd'),'exam_fis_bi'=>$this->input->post('ed_exam_fis_bi'),'exam_fis_ivy'=>$this->input->post('ed_exam_fis_ivy'),'exam_fis_torax'=>$this->input->post('ed_exam_fis_torax'),'exam_fis_coraz'=>$this->input->post('ed_exam_fis_coraz'),'exam_fis_pulm'=>$this->input->post('ed_exam_fis_pulm'),'exam_fis_abdom'=>$this->input->post('ed_exam_fis_abdom'),'exam_fis_miemb'=>$this->input->post('ed_exam_fis_miemb'),'exam_fis_rhy'=>$this->input->post('ed_exam_fis_rhy'),'exam_fis_edema'=>$this->input->post('ed_exam_fis_edema'),'lab_hcto'=>$this->input->post('ed_lab_hcto'),'lab_hb'=>$this->input->post('ed_lab_hb'),'lab_gb'=>$this->input->post('ed_lab_gb'),'lab_plaq'=>$this->input->post('ed_lab_plaq'),'lab_creat'=>$this->input->post('ed_lab_creat'),'lab_glice'=>$this->input->post('ed_lab_glice'),'lab_tgo'=>$this->input->post('ed_lab_tgo'),'lab_tgo_tgp'=>$this->input->post('ed_lab_tgo_tgp'),'lab_tgo_ts_tc'=>$this->input->post('ed_lab_tgo_ts_tc'),'lab_tp'=>$this->input->post('ed_lab_tp'),'lab_tpt'=>$this->input->post('ed_lab_tpt'),'lab_orina'=>$this->input->post('ed_lab_orina'),'res_car_elec'=>$this->input->post('ed_res_car_elec'),'res_car_rad_tor'=>$this->input->post('ed_res_car_rad_tor'),'res_car_eco'=>$this->input->post('ed_res_car_eco'),'res_car_hol'=>$this->input->post('ed_res_car_hol'),'res_car_esperim'=>$this->input->post('ed_res_car_esperim'),'res_car_mapa'=>$this->input->post('ed_res_car_mapa'),'con_diag_pat_car_del'=>$this->input->post('ed_con_diag_pat_car_del'),'con_diag_otros_pat'=>$this->input->post('ed_con_diag_otros_pat'),'riesgo_car_menor'=>$this->input->post('ed_riesgo_car_menor'),'riesgo_car_intermedio'=>$this->input->post('ed_riesgo_car_intermedio'),'riesgo_car_mayor'=>$this->input->post('ed_riesgo_car_mayor'),'riesgo_car_recomend'=>$this->input->post('ed_riesgo_car_recomend'));$where=array('id'=>$this->input->post('id'));$this->db->where($where);$this->db->update("hc_evaluacion_car_vas",$data);$data2=array('peso'=>$this->input->post('ed_cardio_peso'),'kg'=>$this->input->post('ed_cardio_kg'),'talla'=>$this->input->post('ed_cardio_talla'),'imc'=>$this->input->post('ed_cardio_imc'),'ta'=>$this->input->post('ed_cardio_ta'),'fr'=>$this->input->post('ed_cardio_fr'),'fc'=>$this->input->post('ed_cardio_fc'),'hg'=>$this->input->post('ed_cardio_hg'),'tempo'=>$this->input->post('ed_cardio_tempo'),'glicemia'=>$this->input->post('ed_cardio_glicemia'),'pulso'=>$this->input->post('ed_cardio_pulso'),'radio'=>$this->input->post('ed_cardio_radio_signo'));$where2=array('id_cardio'=>$this->input->post('id'));$this->db->where($where2);$this->db->update("h_c_examen_fisico",$data2);}function pagination_card_vascular(){$page=$this->input->get('page');$user_id=$this->input->get('user_id');$id_patient=$this->input->get('id_patient');$data['id_patient']=$id_patient;$data['user_id']=$user_id;$perfil=$this->input->get('perfil');if($perfil=="Admin"){$contition="";}else{$contition="id_user=$user_id AND";}$data['centro_medico']=$this->input->get('centro_medico');$data['page']=$page;$per_page=1;$start=($page-1)*$per_page;$sql="select * from  hc_evaluacion_car_vas  where id=$page";$data['cardiov_paginate']=$this->db->query($sql);$this->load->view('admin/historial-medical1/cardiovascular/paginate',$data);}function showQuirurcaTabulation(){$data['user_id']=$this->input->post('id_user');$data['centro_medico']=$this->input->post('centro_medico');$data['id_historial']=$this->input->post('id_patient');$data['perfil']=$this->db->select('perfil')->where('id_user',$this->input->post('id_user'))->get('users')->row('perfil');$this->load->view('admin/historial-medical1/quirurgia/pagination-number',$data);}function saveQuirurgico(){if($this->input->post('operator')==0){$save=array('id_patient'=>$this->input->post('id_patient'),'id_user'=>$this->input->post('id_user'),'inserted_time'=>date("Y-m-d H:i:s"),'updated_time'=>date("Y-m-d H:i:s"),'diag_pre_qui'=>trim($this->input->post('diag_pre_qui')),'pro_post'=>trim($this->input->post('pro_post')),'diag_post_qui'=>trim($this->input->post('diag_post_qui')),'anestesia'=>trim($this->input->post('anestesia')),'incision'=>trim($this->input->post('incision')),'cirugia_programada'=>trim($this->input->post('cirugia_programada')),'cirugia_realizada'=>trim($this->input->post('cirugia_realizada')),'hallasgo'=>trim($this->input->post('hallasgo')),'desc_proced'=>trim($this->input->post('desc_proced')),'perdida_sanguinea'=>trim($this->input->post('perdida_sanguinea')),'compresa'=>trim($this->input->post('compresa')),'gasas'=>trim($this->input->post('gasas')),'drenes'=>trim($this->input->post('drenes')),'transfusion'=>trim($this->input->post('transfusion')),'unids_transfusion'=>trim($this->input->post('unids_transfusion')),'condicion_paciente'=>trim($this->input->post('condicion_paciente')),'traslado'=>trim($this->input->post('traslado')),'hora_ini'=>trim($this->input->post('hora_ini')),'hora_fin'=>trim($this->input->post('hora_fin')),'tiempo_quirurgico'=>trim($this->input->post('tiempo_quirurgico')),'cirujano'=>trim($this->input->post('cirujano')),'ajudante'=>trim($this->input->post('ajudante')),'ajudante_enf'=>trim($this->input->post('ajudante_enf')),'muestras_patologia'=>trim($this->input->post('muestras_patologia')),'histopatologico'=>trim($this->input->post('histopatologico')),'centro'=>$this->input->post('centro_med_q'));$this->db->insert("hc_quirurgica",$save);}else{$change_time=date("Y-m-d H:i:s",strtotime($this->input->post('fecha_quiri')));$data=array('diag_pre_qui'=>trim($this->input->post('diag_pre_qui')),'pro_post'=>trim($this->input->post('pro_post')),'diag_post_qui'=>trim($this->input->post('diag_post_qui')),'anestesia'=>trim($this->input->post('anestesia')),'incision'=>trim($this->input->post('incision')),'updated_time'=>date("Y-m-d H:i:s"),'updated_by'=>$this->input->post('id_user'),'cirugia_programada'=>trim($this->input->post('cirugia_programada')),'cirugia_realizada'=>trim($this->input->post('cirugia_realizada')),'hallasgo'=>trim($this->input->post('hallasgo')),'desc_proced'=>trim($this->input->post('desc_proced')),'perdida_sanguinea'=>trim($this->input->post('perdida_sanguinea')),'compresa'=>trim($this->input->post('compresa')),'gasas'=>trim($this->input->post('gasas')),'drenes'=>trim($this->input->post('drenes')),'transfusion'=>trim($this->input->post('transfusion')),'unids_transfusion'=>trim($this->input->post('unids_transfusion')),'condicion_paciente'=>trim($this->input->post('condicion_paciente')),'traslado'=>trim($this->input->post('traslado')),'hora_ini'=>trim($this->input->post('hora_ini')),'hora_fin'=>trim($this->input->post('hora_fin')),'tiempo_quirurgico'=>trim($this->input->post('tiempo_quirurgico')),'cirujano'=>trim($this->input->post('cirujano')),'ajudante'=>trim($this->input->post('ajudante')),'ajudante_enf'=>trim($this->input->post('ajudante_enf')),'muestras_patologia'=>trim($this->input->post('muestras_patologia')),'histopatologico'=>trim($this->input->post('histopatologico')),'centro'=>$this->input->post('centro_medico_eq1'));$where=array('id'=>$this->input->post('operator'));$this->db->where($where);$this->db->update("hc_quirurgica",$data);}}function pagination_data_quirurca(){$page=$this->input->get('page');$user_id=$this->input->get('user_id');$id_patient=$this->input->get('id_patient');$data['id_patient']=$id_patient;$data['user_id']=$user_id;$perfil=$this->input->get('perfil');if($perfil=="Admin"){$contition="";}else{$contition="id_user=$user_id AND";}$data['centro_medico_data']=$this->model_admin->view_doctor_centro($user_id);$data['centro_medico']=$this->input->get('centro_medico');$data['page']=$page;$per_page=1;$start=($page-1)*$per_page;$sql="select * from hc_quirurgica where $contition id=$page";$data['cirugia_paginate']=$this->db->query($sql);$this->load->view('admin/historial-medical1/quirurgia/paginate',$data);}function paginationNumberReportScreen(){$data['user_id']=$this->input->post('id_user');$data['centro_medico']=$this->input->post('centro_medico');$data['id_historial']=$this->input->post('id_patient');$data['perfil']=$this->db->select('perfil')->where('id_user',$this->input->post('id_user'))->get('users')->row('perfil');$this->load->view('admin/historial-medical1/trastorno-sueno/screening/pagination-number',$data);}function saveScreening(){if($this->input->post('action')==0){$save=array('snoring'=>$this->input->post('snoring'),'tired'=>$this->input->post('tired'),'observed'=>$this->input->post('observed'),'pressure'=>$this->input->post('pressure'),'body_mass'=>$this->input->post('body_mass'),'height'=>$this->input->post('height'),'weight'=>$this->input->post('weight'),'bmi'=>$this->input->post('bmi'),'age_older'=>$this->input->post('age_older'),'neck_size'=>$this->input->post('neck_size'),'gender'=>$this->input->post('gender'),'height_unit'=>$this->input->post('height_unit'),'weight_unit'=>$this->input->post('weight_unit'),'id_patient'=>$this->input->post('id_patient'),'inserted_by'=>$this->input->post('id_user'),'inserted_time'=>date('Y-m-d H:i:s'),'updated_time'=>date('Y-m-d H:i:s'),'updated_by'=>$this->input->post('id_user'),);$this->db->insert("hc_screening",$save);}else{$data=array('snoring'=>$this->input->post('snoring'),'tired'=>$this->input->post('tired'),'observed'=>$this->input->post('observed'),'pressure'=>$this->input->post('pressure'),'body_mass'=>$this->input->post('body_mass'),'height'=>$this->input->post('height'),'weight'=>$this->input->post('weight'),'bmi'=>$this->input->post('bmi'),'age_older'=>$this->input->post('age_older'),'neck_size'=>$this->input->post('neck_size'),'gender'=>$this->input->post('gender'),'height_unit'=>$this->input->post('height_unit_'),'weight_unit'=>$this->input->post('weight_unit_'),'updated_time'=>date('Y-m-d H:i:s'),'updated_by'=>$this->input->post('id_user'),);$where=array('id'=>$this->input->post('action'));$this->db->where($where);$this->db->update("hc_screening",$data);}}function pagination_data_screening(){$page=$this->input->get('page');$user_id=$this->input->get('user_id');$id_patient=$this->input->get('id_patient');$data['id_patient']=$id_patient;$data['user_id']=$user_id;$data['centro_medico']=$this->input->get('centro_medico');$data['page']=$page;$per_page=1;$start=($page-1)*$per_page;$sql="select * from  hc_screening where id=$page";$data['cirugia_paginate']=$this->db->query($sql);$this->load->view('admin/historial-medical1/trastorno-sueno/screening/paginate',$data);}function deleteReportGeneral(){$where = array('id' =>$this->input->post('id'));$this->db->where($where);$this->db->delete('hc_cirugia_reporte');}}