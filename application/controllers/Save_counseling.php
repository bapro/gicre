<?php defined('BASEPATH')OR exit('No direct script access allowed');class Save_counseling extends CI_Controller{public function __construct(){parent::__construct();$this->load->model('model_admin');$this->load->library('form_validation');}function saveFields(){if($this->input->post('enf_motivo')==""){$response['message']="CAMPO REQUERIDO <br/>Enfemedad Actual: El Motivo de consulta es obligatorio. <span style='color:red;font-size:19px'>*</span>";$response['status']=1;}elseif($this->input->post('enf_signopsis')==""){$response['message']="CAMPO REQUERIDO <br/> Enfemedad Actual: El Signopsis es obligatorio. <span style='color:red;font-size:19px'>*</span>";$response['status']=2;}else{$response['message']="";$response['status']=0;$insert_date=date("Y-m-d H:i:s");$user_id=$this->input->post('user_id');$saveEnf=array('enf_motivo'=>$this->input->post('enf_motivo'),'signopsis'=>$this->input->post('enf_signopsis'),'laboratorios'=>$this->input->post('enf_laboratorios'),'estudios'=>$this->input->post('enf_estudios'),'historial_id'=>$this->input->post('hist_id'),'centro_medico'=>$this->input->post('centro_medico'),'inserted_by'=>$this->input->post('user_id'),'inserted_time'=>date("Y-m-d H:i:s"),'updated_by'=>$this->input->post('user_id'),'updated_time'=>date("Y-m-d H:i:s"),'user_id'=>$this->input->post('user_id'),'filter_date'=>date("Y-m-d"),);$this->model_admin->saveEnfermedad($saveEnf);$idenfact=$this->db->insert_id();$whereimg=array('id_patient'=>$this->input->post('hist_id'),'userid'=>$this->input->post('user_id'),'id_enfermedad'=>0);$updimg=array('id_enfermedad'=>$idenfact);$this->db->where($whereimg);$this->db->update("saveEnfImage",$updimg);$query1=$this->db->get_where('type_reasons',array('title'=>$this->input->post('enf_motivo')));if($query1->num_rows()==0){$save=array('title'=>$this->input->post('enf_motivo'),'inserted_by'=>$this->input->post('user_id'),'inserted_time'=>$insert_date,'updated_by'=>$this->input->post('user_id'),'updated_time'=>$insert_date);$this->model_admin->save_new_causa($save);}$hab_t_drug=$this->input->post('hab_t_drug');$todo_check=$this->input->post('todo_check');$todo_check1=(isset($todo_check))?1:0;$car_nin_check=$this->input->post('car_nin_check');$car_nin_check1=(isset($car_nin_check))?1:0;$madre_check=$this->input->post('madre_check');$madre_check1=(isset($madre_check))?1:0;$padre_check=$this->input->post('padre_check');$padre_check1=(isset($padre_check))?1:0;$car_h_check=$this->input->post('car_h_check');$car_h_check1=(isset($car_h_check))?1:0;$car_pe_check=$this->input->post('car_pe_check');$car_pe_check1=(isset($car_pe_check))?1:0;$nin_check2=$this->input->post('nin_check2');$nin_check22=(isset($nin_check2))?1:0;$madre_check2=$this->input->post('madre_check2');$madre_check22=(isset($madre_check2))?1:0;$padre_check2=$this->input->post('padre_check2');$padre_check22=(isset($padre_check2))?1:0;$h_check2=$this->input->post('h_check2');$h_check22=(isset($h_check2))?1:0;$pe_check2=$this->input->post('pe_check2');$pe_check22=(isset($pe_check2))?1:0;$nin_check3=$this->input->post('nin_check3');$nin_check33=(isset($nin_check3))?1:0;$madre_check3=$this->input->post('madre_check3');$madre_check33=(isset($madre_check3))?1:0;$padre_check3=$this->input->post('padre_check3');$padre_check33=(isset($padre_check3))?1:0;$h_check3=$this->input->post('h_check3');$h_check33=(isset($h_check3))?1:0;$pe_check3=$this->input->post('pe_check3');$pe_check33=(isset($pe_check3))?1:0;$nin_check4=$this->input->post('nin_check4');$nin_check44=(isset($nin_check4))?1:0;$madre_check4=$this->input->post('madre_check4');$madre_check44=(isset($madre_check4))?1:0;$padre_check4=$this->input->post('padre_check4');$padre_check44=(isset($padre_check4))?1:0;$h_check4=$this->input->post('h_check4');$h_check44=(isset($h_check4))?1:0;$pe_check4=$this->input->post('pe_check4');$pe_check44=(isset($pe_check4))?1:0;$nin_check5=$this->input->post('nin_check5');$nin_check55=(isset($nin_check5))?1:0;$madre_check5=$this->input->post('madre_check5');$madre_check55=(isset($madre_check5))?1:0;$padre_check5=$this->input->post('padre_check5');$padre_check55=(isset($padre_check5))?1:0;$h_check5=$this->input->post('h_check5');$h_check55=(isset($h_check5))?1:0;$pe_check5=$this->input->post('pe_check5');$pe_check55=(isset($pe_check5))?1:0;$nin_check05=$this->input->post('nin_check05');$nin_check055=(isset($nin_check05))?1:0;$madre_check05=$this->input->post('madre_check05');$madre_check055=(isset($madre_check05))?1:0;$padre_check05=$this->input->post('padre_check05');$padre_check055=(isset($padre_check05))?1:0;$h_check05=$this->input->post('h_check05');$h_check055=(isset($h_check05))?1:0;$pe_check05=$this->input->post('pe_check05');$pe_check055=(isset($pe_check05))?1:0;$nin_check6=$this->input->post('nin_check6');$nin_check66=(isset($nin_check6))?1:0;$madre_check6=$this->input->post('madre_check6');$madre_check66=(isset($madre_check6))?1:0;$padre_check6=$this->input->post('padre_check6');$padre_check66=(isset($padre_check6))?1:0;$h_check6=$this->input->post('h_check6');$h_check66=(isset($h_check6))?1:0;$pe_check6=$this->input->post('pe_check6');$pe_check66=(isset($pe_check6))?1:0;$nin_check7=$this->input->post('nin_check7');$nin_check77=(isset($nin_check7))?1:0;$madre_check7=$this->input->post('madre_check7');$madre_check77=(isset($madre_check7))?1:0;$padre_check7=$this->input->post('padre_check7');$padre_check77=(isset($padre_check7))?1:0;$h_check7=$this->input->post('h_check7');$h_check77=(isset($h_check7))?1:0;$pe_check7=$this->input->post('pe_check7');$pe_check77=(isset($pe_check7))?1:0;$nin_check8=$this->input->post('nin_check8');$nin_check88=(isset($nin_check8))?1:0;$madre_check8=$this->input->post('madre_check8');$madre_check88=(isset($madre_check8))?1:0;$padre_check8=$this->input->post('padre_check8');$padre_check88=(isset($padre_check8))?1:0;$h_check8=$this->input->post('h_check8');$h_check88=(isset($h_check8))?1:0;$pe_check8=$this->input->post('pe_check8');$pe_check88=(isset($pe_check8))?1:0;$nin_check9=$this->input->post('nin_check9');$nin_check99=(isset($nin_check9))?1:0;$madre_check9=$this->input->post('madre_check9');$madre_check99=(isset($madre_check9))?1:0;$padre_check9=$this->input->post('padre_check9');$padre_check99=(isset($padre_check9))?1:0;$h_check9=$this->input->post('h_check9');$h_check99=(isset($h_check9))?1:0;$pe_check9=$this->input->post('pe_check9');$pe_check99=(isset($pe_check9))?1:0;$nin_check10=$this->input->post('nin_check10');$nin_check1010=(isset($nin_check10))?1:0;$madre_check10=$this->input->post('madre_check10');$madre_check1010=(isset($madre_check10))?1:0;$padre_check10=$this->input->post('padre_check10');$padre_check1010=(isset($padre_check10))?1:0;$h_check10=$this->input->post('h_check10');$h_check1010=(isset($h_check10))?1:0;$pe_check10=$this->input->post('pe_check10');$pe_check1010=(isset($pe_check10))?1:0;$nin_check11=$this->input->post('nin_check11');$nin_check1111=(isset($nin_check11))?1:0;$madre_check11=$this->input->post('madre_check11');$madre_check1111=(isset($madre_check11))?1:0;$padre_check11=$this->input->post('padre_check11');$padre_check1111=(isset($padre_check11))?1:0;$h_check11=$this->input->post('h_check11');$h_check1111=(isset($h_check11))?1:0;$pe_check11=$this->input->post('pe_check11');$pe_check1111=(isset($pe_check11))?1:0;$neop_check12=$this->input->post('neop_check12');$neop_check1212=(isset($neop_check12))?1:0;$madre_check12=$this->input->post('madre_check12');$madre_check1212=(isset($madre_check12))?1:0;$padre_check12=$this->input->post('padre_check12');$padre_check1212=(isset($padre_check12))?1:0;$h_check12=$this->input->post('h_check12');$h_check1212=(isset($h_check12))?1:0;$pe_check12=$this->input->post('pe_check12');$pe_check1212=(isset($pe_check12))?1:0;$psi_check13=$this->input->post('psi_check13');$psi_check1313=(isset($psi_check13))?1:0;$madre_check13=$this->input->post('madre_check13');$madre_check1313=(isset($madre_check13))?1:0;$padre_check13=$this->input->post('padre_check13');$padre_check1313=(isset($padre_check13))?1:0;$h_check13=$this->input->post('h_check13');$h_check1313=(isset($h_check13))?1:0;$pe_check13=$this->input->post('pe_check13');$pe_check1313=(isset($pe_check13))?1:0;$obs_check14=$this->input->post('obs_check14');$obs_check1414=(isset($obs_check14))?1:0;$madre_check14=$this->input->post('madre_check14');$madre_check1414=(isset($madre_check14))?1:0;$padre_check14=$this->input->post('padre_check14');$padre_check1414=(isset($padre_check14))?1:0;$h_check14=$this->input->post('h_check14');$h_check1414=(isset($h_check14))?1:0;$pe_check14=$this->input->post('pe_check14');$pe_check1414=(isset($pe_check14))?1:0;$ulp_check15=$this->input->post('ulp_check15');$ulp_check1515=(isset($ulp_check15))?1:0;$madre_check15=$this->input->post('madre_check15');$madre_check1515=(isset($madre_check15))?1:0;$padre_check15=$this->input->post('padre_check15');$padre_check1515=(isset($padre_check15))?1:0;$h_check15=$this->input->post('h_check15');$h_check1515=(isset($h_check15))?1:0;$pe_check15=$this->input->post('pe_check15');$pe_check1515=(isset($pe_check15))?1:0;$art_check16=$this->input->post('art_check16');$art_check1616=(isset($art_check16))?1:0;$madre_check16=$this->input->post('madre_check16');$madre_check1616=(isset($madre_check16))?1:0;$padre_check16=$this->input->post('padre_check16');$padre_check1616=(isset($padre_check16))?1:0;$h_check16=$this->input->post('h_check16');$h_check1616=(isset($h_check16))?1:0;$pe_check16=$this->input->post('pe_check16');$pe_check1616=(isset($pe_check16))?1:0;$art_check016=$this->input->post('art_check016');$art_check01616=(isset($art_check016))?1:0;$madre_check016=$this->input->post('madre_check016');$madre_check01616=(isset($madre_check016))?1:0;$padre_check016=$this->input->post('padre_check016');$padre_check01616=(isset($padre_check016))?1:0;$h_check016=$this->input->post('h_check016');$h_check01616=(isset($h_check016))?1:0;$pe_check016=$this->input->post('pe_check016');$pe_check01616=(isset($pe_check016))?1:0;$zika_check17=$this->input->post('zika_check17');$zika_check1717=(isset($zika_check17))?1:0;$madre_check17=$this->input->post('madre_check17');$madre_check1717=(isset($madre_check17))?1:0;$padre_check17=$this->input->post('padre_check17');$padre_check1717=(isset($padre_check17))?1:0;$h_check17=$this->input->post('h_check17');$h_check1717=(isset($h_check17))?1:0;$pe_check17=$this->input->post('pe_check17');$pe_check1717=(isset($pe_check17))?1:0;$save=array('todo'=>$todo_check1,'car_nin'=>$car_nin_check1,'car_m'=>$madre_check1,'car_p'=>$padre_check1,'car_h'=>$car_h_check1,'car_pe'=>$car_pe_check1,'car_text'=>$this->input->post('car_text'),'hip_nin'=>$nin_check22,'hip_m'=>$madre_check22,'hip_p'=>$padre_check22,'hip_h'=>$h_check22,'hip_pe'=>$pe_check22,'hip_text'=>$this->input->post('hip_text'),'ec_nin'=>$nin_check33,'ec_m'=>$madre_check33,'ec_p'=>$padre_check33,'ec_h'=>$h_check33,'ec_pe'=>$pe_check33,'ec_text'=>$this->input->post('ec_text'),'ep_nin'=>$nin_check44,'ep_m'=>$madre_check44,'ep_p'=>$padre_check44,'ep_h'=>$h_check44,'ep_pe'=>$pe_check44,'ep_text'=>$this->input->post('ep_text'),'as_nin'=>$nin_check55,'as_m'=>$madre_check55,'as_p'=>$padre_check55,'as_h'=>$h_check55,'as_pe'=>$pe_check55,'as_text'=>$this->input->post('as_text'),'enre_nin'=>$nin_check055,'enre_m'=>$madre_check055,'enre_p'=>$padre_check055,'enre_h'=>$h_check055,'enre_pe'=>$pe_check055,'enre_text'=>$this->input->post('enre_text'),'tub_nin'=>$nin_check66,'tub_m'=>$madre_check66,'tub_p'=>$padre_check66,'tub_h'=>$h_check66,'tub_pe'=>$pe_check66,'tub_text'=>$this->input->post('tub_text'),'dia_nin'=>$nin_check77,'dia_m'=>$madre_check77,'dia_p'=>$padre_check77,'dia_h'=>$h_check77,'dia_pe'=>$pe_check77,'dia_text'=>$this->input->post('dia_text'),'tir_nin'=>$nin_check88,'tir_m'=>$madre_check88,'tir_p'=>$padre_check88,'tir_h'=>$h_check88,'tir_pe'=>$pe_check88,'tir_text'=>$this->input->post('tir_text'),'hep_tipo'=>$this->input->post('hep_tipo'),'hep_nin'=>$nin_check99,'hep_m'=>$madre_check99,'hep_p'=>$padre_check99,'hep_h'=>$h_check99,'hep_pe'=>$pe_check99,'hep_text'=>$this->input->post('hep_text'),'enfr_nin'=>$nin_check1010,'enfr_m'=>$madre_check1010,'enfr_p'=>$padre_check1010,'enfr_h'=>$h_check1010,'enfr_pe'=>$pe_check1010,'enfr_text'=>$this->input->post('enfr_text'),'falc_nin'=>$nin_check1111,'falc_m'=>$madre_check1111,'falc_p'=>$padre_check1111,'falc_h'=>$h_check1111,'falc_pe'=>$pe_check1111,'falc_text'=>$this->input->post('falc_text'),'neop_nin'=>$neop_check1212,'neop_m'=>$madre_check1212,'neop_p'=>$padre_check1212,'neop_h'=>$h_check1212,'neop_pe'=>$pe_check1212,'neop_text'=>$this->input->post('neop_text'),'psi_nin'=>$psi_check1313,'psi_m'=>$madre_check1313,'psi_p'=>$padre_check1313,'psi_h'=>$h_check1313,'psi_pe'=>$pe_check1313,'psi_text'=>$this->input->post('psi_text'),'obs_nin'=>$obs_check1414,'obs_m'=>$madre_check1414,'obs_p'=>$padre_check1414,'obs_h'=>$h_check1414,'obs_pe'=>$pe_check1414,'obs_text'=>$this->input->post('obs_text'),'ulp_nin'=>$ulp_check1515,'ulp_m'=>$madre_check1515,'ulp_p'=>$padre_check1515,'ulp_h'=>$h_check1515,'ulp_pe'=>$pe_check1515,'ulp_text'=>$this->input->post('ulp_text'),'art_nin'=>$art_check1616,'art_m'=>$madre_check1616,'art_p'=>$padre_check1616,'art_h'=>$h_check1616,'art_pe'=>$pe_check1616,'art_text'=>$this->input->post('art_text'),'hem_nin'=>$art_check01616,'hem_m'=>$madre_check01616,'hem_p'=>$padre_check01616,'hem_h'=>$h_check01616,'hem_pe'=>$pe_check01616,'hem_text'=>$this->input->post('hem_text'),'zika_nin'=>$zika_check1717,'zika_m'=>$madre_check1717,'zika_p'=>$padre_check1717,'zika_h'=>$h_check1717,'zika_pe'=>$pe_check1717,'zika_text'=>$this->input->post('zika_text'),'otros'=>$this->input->post('otros'),'historial_id'=>$this->input->post('hist_id'),'date_insert'=>$insert_date,'date_modif'=>$insert_date,'operator'=>$this->input->post('user_id'),'update_by'=>$this->input->post('user_id'),'id_user'=>$this->input->post('user_id'));$idMarPos=$this->model_admin->marquePositivo($save);$counMarP=$this->model_admin->countAnte1($this->input->post('hist_id'));if($counMarP>1){$this->model_admin->DeleteDuplicateMarqueP($idMarPos);}$newMpat=$this->input->post('newMpat');if($newMpat){foreach($newMpat as $key=>$med){$savecd=array('medicine'=>$med,'id_patient'=>$this->input->post('hist_id'),'part'=>'gnl','user_id'=>$this->input->post('user_id'));$this->model_admin->SaveMedicine($savecd);}}$save2=array('maltratof'=>$this->input->post('textmaltrato_g'),'abusos'=>$this->input->post('textabuso_g'),'negligencia'=>$this->input->post('textneg_g'),'maltrato'=>$this->input->post('maltratoemo_g'),'alimentos'=>$this->input->post('alimentos_al'),'medicamentos'=>$this->input->post('medicamentos_al'),'otros'=>$this->input->post('otros_al'),'historial_id'=>$this->input->post('hist_id'),'date_insert'=>$insert_date,'update_time'=>$insert_date,'inserted_by'=>$this->input->post('user_id'),'update_by'=>$this->input->post('user_id'));$idDes=$this->model_admin->DesantAl($save2);$counDesa=$this->model_admin->countDesarollo($this->input->post('hist_id'));if($counDesa>1){$this->model_admin->DeleteEmptyDesarollo($idDes);}$save3=array('quirurgicos'=>$this->input->post('quirurgicos'),'gineco'=>$this->input->post('gineco'),'abdominal'=>$this->input->post('abdominal'),'toracica'=>$this->input->post('toracica'),'transfusion'=>$this->input->post('transfusion'),'otros1'=>$this->input->post('otros1_g'),'hepatis'=>$this->input->post('hepatis'),'hpv'=>$this->input->post('hpv'),'toxoide'=>$this->input->post('toxoide'),'grouposang'=>$this->input->post('grouposang'),'tipificacion'=>$this->input->post('tipificacion'),'rh'=>$this->input->post('rhoa'),'violencia1'=>$this->input->post('violencia1'),'violencia2'=>$this->input->post('violencia2'),'violencia3'=>$this->input->post('violencia3'),'violencia4'=>$this->input->post('violencia4'),'historial_id'=>$this->input->post('hist_id'),'inserted_time'=>$insert_date,'inserted_by'=>$this->input->post('user_id'));$idAtO=$this->model_admin->saveAnteOtros($save3);$counAntOt=$this->model_admin->countAntOtros($this->input->post('hist_id'));if($counAntOt>1){$this->model_admin->DeleteAntOtros($idAtO);}if(!empty($medicine)){foreach($medicine as $med){$save=array('medicine'=>$med,'id_patient'=>$this->input->post('hist_id'),'user_id'=>$this->input->post('user_id'));$this->model_admin->SaveMedicine($save);};};$this->model_admin->deleteMedNinguno();$save4=array('cafe_cant'=>$this->input->post('hab_c_caf'),'cafe_frec'=>$this->input->post('hab_f_caf'),'pipa_cant'=>$this->input->post('hab_c_pip'),'pipa_frec'=>$this->input->post('hab_f_pip'),'ciga_can'=>$this->input->post('hab_c_ciga'),'ciga_frec'=>$this->input->post('hab_f_ciga'),'alc_can'=>$this->input->post('hab_c_al'),'alc_frec'=>$this->input->post('hab_f_al'),'tab_can'=>$this->input->post('hab_c_tab'),'tab_frec'=>$this->input->post('hab_f_tab'),'hab_c_drug'=>$this->input->post('hab_c_drug'),'hab_f_drug'=>$this->input->post('hab_f_drug'),'hookah'=>$this->input->post('hookah'),'hab_f_hookah'=>$this->input->post('hab_f_hookah'),'historial_id'=>$this->input->post('hist_id'),'inserted_by'=>$this->input->post('user_id'),'inserted_time'=>$insert_date,'update_time'=>$insert_date);$idHabT=$this->model_admin->saveHabitosToxicos($save4);$counHabT=$this->model_admin->countHabitosToxicos($this->input->post('hist_id'));if($counHabT>1){$this->model_admin->DeleteEmptyHabitosToxicos($idHabT);}if(!empty($hab_t_drug)){foreach($hab_t_drug as $drug){$save=array('name'=>$drug,'id_patient'=>$this->input->post('hist_id'));$this->model_admin->SaveDrug($save);};}$aoc=$this->input->post('aoc');$aoc1=(isset($aoc))?1:0;$diu=$this->input->post('diu');$diu1=(isset($diu))?1:0;$implante=$this->input->post('implante');$implante1=(isset($implante))?1:0;$siu=$this->input->post('siu');$siu1=(isset($siu))?1:0;$condones=$this->input->post('condones');$condones1=(isset($condones))?1:0;$anti_emergencia=$this->input->post('anti_emergencia');$anti_emergencia1=(isset($anti_emergencia))?1:0;$aqv=$this->input->post('aqv');$aqv1=(isset($aqv))?1:0;$inyectable1=$this->input->post('inyectable1');$inyectable11=(isset($inyectable1))?1:0;$inyectable3=$this->input->post('inyectable3');$inyectable31=(isset($inyectable3))?1:0;$solo_pro=$this->input->post('solo_pro');$solo_pro1=(isset($solo_pro))?1:0;$vio_basada=$this->input->post('vio_basada');$vio_basada1=(isset($vio_basada))?1:0;$pre_prueba_vih=$this->input->post('pre_prueba_vih');$pre_prueba_vih1=(isset($pre_prueba_vih))?1:0;$prost_prueba_vih_mas=$this->input->post('prost_prueba_vih_mas');$prost_prueba_vih_mas1=(isset($prost_prueba_vih_mas))?1:0;$prost_prueba_vih_menos=$this->input->post('prost_prueba_vih_menos');$prost_prueba_vih_menos1=(isset($prost_prueba_vih_menos))?1:0;$con_ad_arv=$this->input->post('con_ad_arv');$con_ad_arv1=(isset($con_ad_arv))?1:0;$ap_ps_vih=$this->input->post('ap_ps_vih');$ap_ps_vih1=(isset($ap_ps_vih))?1:0;$infertilidad=$this->input->post('infertilidad');$infertilidad1=(isset($infertilidad))?1:0;$cancer_mama=$this->input->post('cancer_mama');$cancer_mama1=(isset($cancer_mama))?1:0;$prueba_pre_post=$this->input->post('prueba_pre_post');$prueba_pre_post1=(isset($prueba_pre_post))?1:0;$reduce_riesgo=$this->input->post('reduce_riesgo');$reduce_riesgo1=(isset($reduce_riesgo))?1:0;$post_aborto=$this->input->post('post_aborto');$post_aborto1=(isset($post_aborto))?1:0;$zika=$this->input->post('zika');$zika1=(isset($zika))?1:0;$pre_post_prueba_its=$this->input->post('pre_post_prueba_its');$pre_post_prueba_its1=(isset($pre_post_prueba_its))?1:0;$sexualidad=$this->input->post('sexualidad');$sexualidad1=(isset($sexualidad))?1:0;$pre_natal=$this->input->post('pre_natal');$pre_natal1=(isset($pre_natal))?1:0;$reduce_riesgo_its=$this->input->post('reduce_riesgo_its');$reduce_riesgo_its1=(isset($reduce_riesgo_its))?1:0;$ref_gineco=$this->input->post('ref_gineco');$ref_gineco1=(isset($ref_gineco))?1:0;$ref_obs=$this->input->post('ref_obs');$ref_obs1=(isset($ref_obs))?1:0;$ref_uro=$this->input->post('ref_uro');$ref_uro1=(isset($ref_uro))?1:0;$ref_infet=$this->input->post('ref_infet');$ref_infet1=(isset($ref_infet))?1:0;$ref_pedia=$this->input->post('ref_pedia');$ref_pedia1=(isset($ref_pedia))?1:0;$ref_pws=$this->input->post('ref_pws');$ref_pws1=(isset($ref_pws))?1:0;$ref_otro_serv=$this->input->post('ref_otro_serv');$ref_otro_serv1=(isset($ref_otro_serv))?1:0;$ref_apoyo_emo=$this->input->post('ref_apoyo_emo');$ref_apoyo_emo1=(isset($ref_apoyo_emo))?1:0;$ref_endo=$this->input->post('ref_endo');$ref_endo1=(isset($ref_endo))?1:0;$ref_servicio=$this->input->post('ref_servicio');$ref_servicio1=(isset($ref_servicio))?1:0;$ref_serv_legal=$this->input->post('ref_serv_legal');$ref_serv_legal1=(isset($ref_serv_legal))?1:0;$ref_onco=$this->input->post('ref_onco');$ref_onco1=(isset($ref_onco))?1:0;$ref_obs_mat=$this->input->post('ref_obs_mat');$ref_obs_mat1=(isset($ref_obs_mat))?1:0;$data_counceling=array('anti_radio'=>$this->input->post('anti_radio'),'aoc'=>$aoc1,'diu'=>$diu1,'implante'=>$implante1,'siu'=>$siu1,'condones'=>$condones1,'anti_emergencia'=>$anti_emergencia1,'aqv'=>$aqv1,'inyectable1'=>$inyectable11,'inyectable3'=>$inyectable31,'solo_pro'=>$solo_pro1,'contraception_otro'=>$this->input->post('contraception_otro'),'deseo_uso'=>$this->input->post('deseo_uso'),'deseo_cambio1'=>$this->input->post('deseo_cambio1'),'deseo_cambio2'=>$this->input->post('deseo_cambio2'),'motivo_uso'=>$this->input->post('motivo_uso'),'deseo_retiro'=>$this->input->post('deseo_retiro'),'aclara_dudas'=>$this->input->post('aclara_dudas'),'aclara_dudas_esp'=>$this->input->post('aclara_dudas_esp'),'momento_uso'=>$this->input->post('momento_uso'),'vio_basada'=>$vio_basada1,'pre_prueba_vih'=>$pre_prueba_vih1,'prost_prueba_vih_mas'=>$prost_prueba_vih_mas1,'prost_prueba_vih_menos'=>$prost_prueba_vih_menos1,'con_ad_arv'=>$con_ad_arv1,'ap_ps_vih'=>$ap_ps_vih1,'infertilidad'=>$infertilidad1,'cancer_mama'=>$cancer_mama1,'prueba_pre_post'=>$prueba_pre_post1,'reduce_riesgo'=>$reduce_riesgo1,'post_aborto'=>$post_aborto1,'zika'=>$zika1,'pre_post_prueba_its'=>$pre_post_prueba_its1,'sexualidad'=>$sexualidad1,'pre_natal'=>$pre_natal1,'reduce_riesgo_its'=>$reduce_riesgo_its1,'otro_conselling'=>$this->input->post('otro_conselling'),'tipo_servicio'=>$this->input->post('tipo_servicio'),'ref_anti'=>$this->input->post('ref_anti'),'ref_gineco'=>$ref_gineco1,'ref_obs'=>$ref_obs1,'ref_uro'=>$ref_uro1,'ref_infet'=>$ref_infet1,'ref_pedia'=>$ref_pedia1,'ref_pws'=>$ref_pws1,'ref_otro_serv'=>$ref_otro_serv1,'ref_apoyo_emo'=>$ref_apoyo_emo1,'ref_endo'=>$ref_endo1,'ref_servicio'=>$ref_servicio1,'ref_otro1'=>$this->input->post('ref_otro1'),'ref_serv_legal'=>$ref_serv_legal1,'ref_onco'=>$ref_onco1,'ref_obs_mat'=>$ref_obs_mat1,'ref_otro2'=>$this->input->post('ref_otro2'),'comment_counselling'=>$this->input->post('comment_counselling'),'id_patient'=>$this->input->post('hist_id'),'id_user'=>$this->input->post('user_id'),'inserted_by'=>$this->input->post('user_id'),'updated_by'=>$this->input->post('user_id'),'inserted_time'=>$insert_date,'updated_time'=>$insert_date,'id_centro'=>$this->input->post('centro_medico'));$this->db->insert("h_c_counsellig",$data_counceling);}echo json_encode($response);}function updateCounseling(){$id=$this->input->post('id');$insert_date=date("Y-m-d H:i:s");$aoc=$this->input->post('aoc');$aoc1=(isset($aoc))?1:0;$diu=$this->input->post('diu');$diu1=(isset($diu))?1:0;$implante=$this->input->post('implante');$implante1=(isset($implante))?1:0;$siu=$this->input->post('siu');$siu1=(isset($siu))?1:0;$condones=$this->input->post('condones');$condones1=(isset($condones))?1:0;$anti_emergencia=$this->input->post('anti_emergencia');$anti_emergencia1=(isset($anti_emergencia))?1:0;$aqv=$this->input->post('aqv');$aqv1=(isset($aqv))?1:0;$inyectable1=$this->input->post('inyectable1');$inyectable11=(isset($inyectable1))?1:0;$inyectable3=$this->input->post('inyectable3');$inyectable31=(isset($inyectable3))?1:0;$solo_pro=$this->input->post('solo_pro');$solo_pro1=(isset($solo_pro))?1:0;$vio_basada=$this->input->post('vio_basada');$vio_basada1=(isset($vio_basada))?1:0;$pre_prueba_vih=$this->input->post('pre_prueba_vih');$pre_prueba_vih1=(isset($pre_prueba_vih))?1:0;$prost_prueba_vih_mas=$this->input->post('prost_prueba_vih_mas');$prost_prueba_vih_mas1=(isset($prost_prueba_vih_mas))?1:0;$prost_prueba_vih_menos=$this->input->post('prost_prueba_vih_menos');$prost_prueba_vih_menos1=(isset($prost_prueba_vih_menos))?1:0;$con_ad_arv=$this->input->post('con_ad_arv');$con_ad_arv1=(isset($con_ad_arv))?1:0;$ap_ps_vih=$this->input->post('ap_ps_vih');$ap_ps_vih1=(isset($ap_ps_vih))?1:0;$infertilidad=$this->input->post('infertilidad');$infertilidad1=(isset($infertilidad))?1:0;$cancer_mama=$this->input->post('cancer_mama');$cancer_mama1=(isset($cancer_mama))?1:0;$prueba_pre_post=$this->input->post('prueba_pre_post');$prueba_pre_post1=(isset($prueba_pre_post))?1:0;$reduce_riesgo=$this->input->post('reduce_riesgo');$reduce_riesgo1=(isset($reduce_riesgo))?1:0;$post_aborto=$this->input->post('post_aborto');$post_aborto1=(isset($post_aborto))?1:0;$zika=$this->input->post('zika');$zika1=(isset($zika))?1:0;$pre_post_prueba_its=$this->input->post('pre_post_prueba_its');$pre_post_prueba_its1=(isset($pre_post_prueba_its))?1:0;$sexualidad=$this->input->post('sexualidad');$sexualidad1=(isset($sexualidad))?1:0;$pre_natal=$this->input->post('pre_natal');$pre_natal1=(isset($pre_natal))?1:0;$reduce_riesgo_its=$this->input->post('reduce_riesgo_its');$reduce_riesgo_its1=(isset($reduce_riesgo_its))?1:0;$ref_gineco=$this->input->post('ref_gineco');$ref_gineco1=(isset($ref_gineco))?1:0;$ref_obs=$this->input->post('ref_obs');$ref_obs1=(isset($ref_obs))?1:0;$ref_uro=$this->input->post('ref_uro');$ref_uro1=(isset($ref_uro))?1:0;$ref_infet=$this->input->post('ref_infet');$ref_infet1=(isset($ref_infet))?1:0;$ref_pedia=$this->input->post('ref_pedia');$ref_pedia1=(isset($ref_pedia))?1:0;$ref_pws=$this->input->post('ref_pws');$ref_pws1=(isset($ref_pws))?1:0;$ref_otro_serv=$this->input->post('ref_otro_serv');$ref_otro_serv1=(isset($ref_otro_serv))?1:0;$ref_apoyo_emo=$this->input->post('ref_apoyo_emo');$ref_apoyo_emo1=(isset($ref_apoyo_emo))?1:0;$ref_endo=$this->input->post('ref_endo');$ref_endo1=(isset($ref_endo))?1:0;$ref_servicio=$this->input->post('ref_servicio');$ref_servicio1=(isset($ref_servicio))?1:0;$ref_serv_legal=$this->input->post('ref_serv_legal');$ref_serv_legal1=(isset($ref_serv_legal))?1:0;$ref_onco=$this->input->post('ref_onco');$ref_onco1=(isset($ref_onco))?1:0;$ref_obs_mat=$this->input->post('ref_obs_mat');$ref_obs_mat1=(isset($ref_obs_mat))?1:0;$data=array('anti_radio'=>$this->input->post('anti_radio'),'aoc'=>$aoc1,'diu'=>$diu1,'implante'=>$implante1,'siu'=>$siu1,'condones'=>$condones1,'anti_emergencia'=>$anti_emergencia1,'aqv'=>$aqv1,'inyectable1'=>$inyectable11,'inyectable3'=>$inyectable31,'solo_pro'=>$solo_pro1,'contraception_otro'=>$this->input->post('contraception_otro'),'deseo_uso'=>$this->input->post('deseo_uso'),'deseo_cambio1'=>$this->input->post('deseo_cambio1'),'deseo_cambio2'=>$this->input->post('deseo_cambio2'),'motivo_uso'=>$this->input->post('motivo_uso'),'deseo_retiro'=>$this->input->post('deseo_retiro'),'aclara_dudas'=>$this->input->post('aclara_dudas'),'aclara_dudas_esp'=>$this->input->post('aclara_dudas_esp'),'momento_uso'=>$this->input->post('momento_uso'),'vio_basada'=>$vio_basada1,'pre_prueba_vih'=>$pre_prueba_vih1,'prost_prueba_vih_mas'=>$prost_prueba_vih_mas1,'prost_prueba_vih_menos'=>$prost_prueba_vih_menos1,'con_ad_arv'=>$con_ad_arv1,'ap_ps_vih'=>$ap_ps_vih1,'infertilidad'=>$infertilidad1,'cancer_mama'=>$cancer_mama1,'prueba_pre_post'=>$prueba_pre_post1,'reduce_riesgo'=>$reduce_riesgo1,'post_aborto'=>$post_aborto1,'zika'=>$zika1,'pre_post_prueba_its'=>$pre_post_prueba_its1,'sexualidad'=>$sexualidad1,'pre_natal'=>$pre_natal1,'reduce_riesgo_its'=>$reduce_riesgo_its1,'otro_conselling'=>$this->input->post('otro_conselling'),'tipo_servicio'=>$this->input->post('tipo_servicio'),'ref_anti'=>$this->input->post('ref_anti'),'ref_gineco'=>$ref_gineco1,'ref_obs'=>$ref_obs1,'ref_uro'=>$ref_uro1,'ref_infet'=>$ref_infet1,'ref_pedia'=>$ref_pedia1,'ref_pws'=>$ref_pws1,'ref_otro_serv'=>$ref_otro_serv1,'ref_apoyo_emo'=>$ref_apoyo_emo1,'ref_endo'=>$ref_endo1,'ref_servicio'=>$ref_servicio1,'ref_otro1'=>$this->input->post('ref_otro1'),'ref_serv_legal'=>$ref_serv_legal1,'ref_onco'=>$ref_onco1,'ref_obs_mat'=>$ref_obs_mat1,'ref_otro2'=>$this->input->post('ref_otro2'),'comment_counselling'=>$this->input->post('comment_counselling'),'updated_by'=>$this->input->post('id_user'),'updated_time'=>$insert_date,);$where=array('id'=>$id);$this->db->where($where);$result=$this->db->update("h_c_counsellig",$data);if($result){$response['status']=1;$response['message']='<div class="alert alert-success">Cambio Hecho!</div>';}else{$response['status']=0;$response['message']='<div class="alert alert-danger">Cambio Fallo!</div>!';}echo json_encode($response);}}